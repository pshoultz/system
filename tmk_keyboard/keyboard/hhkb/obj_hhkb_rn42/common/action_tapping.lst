   1               		.file	"action_tapping.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text.debug_waiting_buffer,"ax",@progbits
  12               	debug_waiting_buffer:
  13               	.LFB11:
  14               		.file 1 "../../tmk_core/common/action_tapping.c"
   1:../../tmk_core/common/action_tapping.c **** #include <stdint.h>
   2:../../tmk_core/common/action_tapping.c **** #include <stdbool.h>
   3:../../tmk_core/common/action_tapping.c **** #include "action.h"
   4:../../tmk_core/common/action_tapping.c **** #include "action_layer.h"
   5:../../tmk_core/common/action_tapping.c **** #include "action_tapping.h"
   6:../../tmk_core/common/action_tapping.c **** #include "keycode.h"
   7:../../tmk_core/common/action_tapping.c **** #include "timer.h"
   8:../../tmk_core/common/action_tapping.c **** 
   9:../../tmk_core/common/action_tapping.c **** #ifdef DEBUG_ACTION
  10:../../tmk_core/common/action_tapping.c **** #include "debug.h"
  11:../../tmk_core/common/action_tapping.c **** #else
  12:../../tmk_core/common/action_tapping.c **** #include "nodebug.h"
  13:../../tmk_core/common/action_tapping.c **** #endif
  14:../../tmk_core/common/action_tapping.c **** 
  15:../../tmk_core/common/action_tapping.c **** #ifndef NO_ACTION_TAPPING
  16:../../tmk_core/common/action_tapping.c **** 
  17:../../tmk_core/common/action_tapping.c **** #define IS_TAPPING()            !IS_NOEVENT(tapping_key.event)
  18:../../tmk_core/common/action_tapping.c **** #define IS_TAPPING_PRESSED()    (IS_TAPPING() && tapping_key.event.pressed)
  19:../../tmk_core/common/action_tapping.c **** #define IS_TAPPING_RELEASED()   (IS_TAPPING() && !tapping_key.event.pressed)
  20:../../tmk_core/common/action_tapping.c **** #define IS_TAPPING_KEY(k)       (IS_TAPPING() && KEYEQ(tapping_key.event.key, (k)))
  21:../../tmk_core/common/action_tapping.c **** #define WITHIN_TAPPING_TERM(e)  (TIMER_DIFF_16(e.time, tapping_key.event.time) < TAPPING_TERM)
  22:../../tmk_core/common/action_tapping.c **** 
  23:../../tmk_core/common/action_tapping.c **** 
  24:../../tmk_core/common/action_tapping.c **** static keyrecord_t tapping_key = {};
  25:../../tmk_core/common/action_tapping.c **** static keyrecord_t waiting_buffer[WAITING_BUFFER_SIZE] = {};
  26:../../tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_head = 0;
  27:../../tmk_core/common/action_tapping.c **** static uint8_t waiting_buffer_tail = 0;
  28:../../tmk_core/common/action_tapping.c **** 
  29:../../tmk_core/common/action_tapping.c **** static bool process_tapping(keyrecord_t *record);
  30:../../tmk_core/common/action_tapping.c **** static bool waiting_buffer_enq(keyrecord_t record);
  31:../../tmk_core/common/action_tapping.c **** static void waiting_buffer_clear(void);
  32:../../tmk_core/common/action_tapping.c **** static bool waiting_buffer_typed(keyevent_t event);
  33:../../tmk_core/common/action_tapping.c **** static void waiting_buffer_scan_tap(void);
  34:../../tmk_core/common/action_tapping.c **** static void debug_tapping_key(void);
  35:../../tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void);
  36:../../tmk_core/common/action_tapping.c **** 
  37:../../tmk_core/common/action_tapping.c **** 
  38:../../tmk_core/common/action_tapping.c **** void action_tapping_process(keyrecord_t record)
  39:../../tmk_core/common/action_tapping.c **** {
  40:../../tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
  41:../../tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
  42:../../tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
  43:../../tmk_core/common/action_tapping.c ****         }
  44:../../tmk_core/common/action_tapping.c ****     } else {
  45:../../tmk_core/common/action_tapping.c ****         if (!waiting_buffer_enq(record)) {
  46:../../tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
  47:../../tmk_core/common/action_tapping.c ****             debug("OVERFLOW: CLEAR ALL STATES\n");
  48:../../tmk_core/common/action_tapping.c ****             clear_keyboard();
  49:../../tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
  50:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
  51:../../tmk_core/common/action_tapping.c ****         }
  52:../../tmk_core/common/action_tapping.c ****     }
  53:../../tmk_core/common/action_tapping.c **** 
  54:../../tmk_core/common/action_tapping.c ****     // process waiting_buffer
  55:../../tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event) && waiting_buffer_head != waiting_buffer_tail) {
  56:../../tmk_core/common/action_tapping.c ****         debug("---- action_exec: process waiting_buffer -----\n");
  57:../../tmk_core/common/action_tapping.c ****     }
  58:../../tmk_core/common/action_tapping.c ****     for (; waiting_buffer_tail != waiting_buffer_head; waiting_buffer_tail = (waiting_buffer_tail +
  59:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
  60:../../tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
  61:../../tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
  62:../../tmk_core/common/action_tapping.c ****         } else {
  63:../../tmk_core/common/action_tapping.c ****             break;
  64:../../tmk_core/common/action_tapping.c ****         }
  65:../../tmk_core/common/action_tapping.c ****     }
  66:../../tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event)) {
  67:../../tmk_core/common/action_tapping.c ****         debug("\n");
  68:../../tmk_core/common/action_tapping.c ****     }
  69:../../tmk_core/common/action_tapping.c **** }
  70:../../tmk_core/common/action_tapping.c **** 
  71:../../tmk_core/common/action_tapping.c **** 
  72:../../tmk_core/common/action_tapping.c **** /* Tapping
  73:../../tmk_core/common/action_tapping.c ****  *
  74:../../tmk_core/common/action_tapping.c ****  * Rule: Tap key is typed(pressed and released) within TAPPING_TERM.
  75:../../tmk_core/common/action_tapping.c ****  *       (without interfering by typing other key)
  76:../../tmk_core/common/action_tapping.c ****  */
  77:../../tmk_core/common/action_tapping.c **** /* return true when key event is processed or consumed. */
  78:../../tmk_core/common/action_tapping.c **** bool process_tapping(keyrecord_t *keyp)
  79:../../tmk_core/common/action_tapping.c **** {
  80:../../tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
  81:../../tmk_core/common/action_tapping.c **** 
  82:../../tmk_core/common/action_tapping.c ****     // if tapping
  83:../../tmk_core/common/action_tapping.c ****     if (IS_TAPPING_PRESSED()) {
  84:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
  85:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
  86:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
  87:../../tmk_core/common/action_tapping.c ****                     // first tap!
  88:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: First tap(0->1).\n");
  89:../../tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
  90:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
  91:../../tmk_core/common/action_tapping.c ****                     process_action(&tapping_key);
  92:../../tmk_core/common/action_tapping.c **** 
  93:../../tmk_core/common/action_tapping.c ****                     // copy tapping state
  94:../../tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
  95:../../tmk_core/common/action_tapping.c ****                     // enqueue
  96:../../tmk_core/common/action_tapping.c ****                     return false;
  97:../../tmk_core/common/action_tapping.c ****                 }
  98:../../tmk_core/common/action_tapping.c **** #if TAPPING_TERM >= 500
  99:../../tmk_core/common/action_tapping.c ****                 /* Process a key typed within TAPPING_TERM
 100:../../tmk_core/common/action_tapping.c ****                  * This can register the key before settlement of tapping,
 101:../../tmk_core/common/action_tapping.c ****                  * useful for long TAPPING_TERM but may prevent fast typing.
 102:../../tmk_core/common/action_tapping.c ****                  */
 103:../../tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && waiting_buffer_typed(event)) {
 104:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 105:../../tmk_core/common/action_tapping.c ****                     process_action(&tapping_key);
 106:../../tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 107:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 108:../../tmk_core/common/action_tapping.c ****                     // enqueue
 109:../../tmk_core/common/action_tapping.c ****                     return false;
 110:../../tmk_core/common/action_tapping.c ****                 }
 111:../../tmk_core/common/action_tapping.c **** #endif
 112:../../tmk_core/common/action_tapping.c ****                 /* Process release event of a key pressed before tapping starts
 113:../../tmk_core/common/action_tapping.c ****                  * Without this unexpected repeating will occur with having fast repeating setting
 114:../../tmk_core/common/action_tapping.c ****                  * https://github.com/tmk/tmk_keyboard/issues/60
 115:../../tmk_core/common/action_tapping.c ****                  */
 116:../../tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && !waiting_buffer_typed(event)) {
 117:../../tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 118:../../tmk_core/common/action_tapping.c ****                     action_t action = layer_switch_get_action(event);
 119:../../tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 120:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 121:../../tmk_core/common/action_tapping.c ****                         case ACT_RMODS:
 122:../../tmk_core/common/action_tapping.c ****                             if (action.key.mods && !action.key.code) return false;
 123:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 124:../../tmk_core/common/action_tapping.c ****                             break;
 125:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS_TAP:
 126:../../tmk_core/common/action_tapping.c ****                         case ACT_RMODS_TAP:
 127:../../tmk_core/common/action_tapping.c ****                             if (action.key.mods && keyp->tap.count == 0) return false;
 128:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 129:../../tmk_core/common/action_tapping.c ****                             break;
 130:../../tmk_core/common/action_tapping.c ****                     }
 131:../../tmk_core/common/action_tapping.c ****                     // Release of key should be process immediately.
 132:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: release event of a key pressed before tapping\n");
 133:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 134:../../tmk_core/common/action_tapping.c ****                     return true;
 135:../../tmk_core/common/action_tapping.c ****                 }
 136:../../tmk_core/common/action_tapping.c ****                 else {
 137:../../tmk_core/common/action_tapping.c ****                     // set interrupted flag when other key preesed during tapping
 138:../../tmk_core/common/action_tapping.c ****                     if (event.pressed) {
 139:../../tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 140:../../tmk_core/common/action_tapping.c ****                     }
 141:../../tmk_core/common/action_tapping.c ****                     // enqueue 
 142:../../tmk_core/common/action_tapping.c ****                     return false;
 143:../../tmk_core/common/action_tapping.c ****                 }
 144:../../tmk_core/common/action_tapping.c ****             }
 145:../../tmk_core/common/action_tapping.c ****             // tap_count > 0
 146:../../tmk_core/common/action_tapping.c ****             else {
 147:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 148:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 149:../../tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 150:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 151:../../tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 152:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 153:../../tmk_core/common/action_tapping.c ****                     return true;
 154:../../tmk_core/common/action_tapping.c ****                 }
 155:../../tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event) && event.pressed) {
 156:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 157:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 158:../../tmk_core/common/action_tapping.c ****                         // unregister key
 159:../../tmk_core/common/action_tapping.c ****                         process_action(&(keyrecord_t){
 160:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 161:../../tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 162:../../tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 163:../../tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 164:../../tmk_core/common/action_tapping.c ****                         });
 165:../../tmk_core/common/action_tapping.c ****                     } else {
 166:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last tap(1).\n");
 167:../../tmk_core/common/action_tapping.c ****                     }
 168:../../tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 169:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 170:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 171:../../tmk_core/common/action_tapping.c ****                     return true;
 172:../../tmk_core/common/action_tapping.c ****                 }
 173:../../tmk_core/common/action_tapping.c ****                 else {
 174:../../tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 175:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 176:../../tmk_core/common/action_tapping.c ****                     }
 177:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 178:../../tmk_core/common/action_tapping.c ****                     return true;
 179:../../tmk_core/common/action_tapping.c ****                 }
 180:../../tmk_core/common/action_tapping.c ****             }
 181:../../tmk_core/common/action_tapping.c ****         }
 182:../../tmk_core/common/action_tapping.c ****         // after TAPPING_TERM
 183:../../tmk_core/common/action_tapping.c ****         else {
 184:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 185:../../tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 186:../../tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 187:../../tmk_core/common/action_tapping.c ****                 process_action(&tapping_key);
 188:../../tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 189:../../tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 190:../../tmk_core/common/action_tapping.c ****                 return false;
 191:../../tmk_core/common/action_tapping.c ****             }  else {
 192:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 193:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 194:../../tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 195:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 196:../../tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 197:../../tmk_core/common/action_tapping.c ****                     return true;
 198:../../tmk_core/common/action_tapping.c ****                 }
 199:../../tmk_core/common/action_tapping.c ****                 else if (is_tap_key(event) && event.pressed) {
 200:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 201:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 202:../../tmk_core/common/action_tapping.c ****                         // unregister key
 203:../../tmk_core/common/action_tapping.c ****                         process_action(&(keyrecord_t){
 204:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 205:../../tmk_core/common/action_tapping.c ****                                 .event.key = tapping_key.event.key,
 206:../../tmk_core/common/action_tapping.c ****                                 .event.time = event.time,
 207:../../tmk_core/common/action_tapping.c ****                                 .event.pressed = false
 208:../../tmk_core/common/action_tapping.c ****                         });
 209:../../tmk_core/common/action_tapping.c ****                     } else {
 210:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last timeout tap(1).\n");
 211:../../tmk_core/common/action_tapping.c ****                     }
 212:../../tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 213:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 214:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 215:../../tmk_core/common/action_tapping.c ****                     return true;
 216:../../tmk_core/common/action_tapping.c ****                 }
 217:../../tmk_core/common/action_tapping.c ****                 else {
 218:../../tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 219:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last timeout tap(>0).\n");
 220:../../tmk_core/common/action_tapping.c ****                     }
 221:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 222:../../tmk_core/common/action_tapping.c ****                     return true;
 223:../../tmk_core/common/action_tapping.c ****                 }
 224:../../tmk_core/common/action_tapping.c ****             }
 225:../../tmk_core/common/action_tapping.c ****         }
 226:../../tmk_core/common/action_tapping.c ****     } else if (IS_TAPPING_RELEASED()) {
 227:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 228:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 229:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 230:../../tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 231:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 232:../../tmk_core/common/action_tapping.c ****                         keyp->tap = tapping_key.tap;
 233:../../tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 234:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 235:../../tmk_core/common/action_tapping.c ****                         process_action(keyp);
 236:../../tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 237:../../tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 238:../../tmk_core/common/action_tapping.c ****                         return true;
 239:../../tmk_core/common/action_tapping.c ****                     } else {
 240:../../tmk_core/common/action_tapping.c ****                         // FIX: start new tap again
 241:../../tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 242:../../tmk_core/common/action_tapping.c ****                         return true;
 243:../../tmk_core/common/action_tapping.c ****                     }
 244:../../tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event)) {
 245:../../tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 246:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Start with interfering other tap.\n");
 247:../../tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 248:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 249:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 250:../../tmk_core/common/action_tapping.c ****                     return true;
 251:../../tmk_core/common/action_tapping.c ****                 } else {
 252:../../tmk_core/common/action_tapping.c ****                     // should none in buffer
 253:../../tmk_core/common/action_tapping.c ****                     // FIX: interrupted when other key is pressed
 254:../../tmk_core/common/action_tapping.c ****                     tapping_key.tap.interrupted = true;
 255:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 256:../../tmk_core/common/action_tapping.c ****                     return true;
 257:../../tmk_core/common/action_tapping.c ****                 }
 258:../../tmk_core/common/action_tapping.c ****             } else {
 259:../../tmk_core/common/action_tapping.c ****                 if (!IS_NOEVENT(event)) debug("Tapping: other key just after tap.\n");
 260:../../tmk_core/common/action_tapping.c ****                 process_action(keyp);
 261:../../tmk_core/common/action_tapping.c ****                 return true;
 262:../../tmk_core/common/action_tapping.c ****             }
 263:../../tmk_core/common/action_tapping.c ****         } else {
 264:../../tmk_core/common/action_tapping.c ****             // FIX: process_aciton here?
 265:../../tmk_core/common/action_tapping.c ****             // timeout. no sequential tap.
 266:../../tmk_core/common/action_tapping.c ****             debug("Tapping: End(Timeout after releasing last tap): ");
 267:../../tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 268:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 269:../../tmk_core/common/action_tapping.c ****             debug_tapping_key();
 270:../../tmk_core/common/action_tapping.c ****             return false;
 271:../../tmk_core/common/action_tapping.c ****         }
 272:../../tmk_core/common/action_tapping.c ****     }
 273:../../tmk_core/common/action_tapping.c ****     // not tapping state
 274:../../tmk_core/common/action_tapping.c ****     else {
 275:../../tmk_core/common/action_tapping.c ****         if (event.pressed && is_tap_key(event)) {
 276:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 277:../../tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 278:../../tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 279:../../tmk_core/common/action_tapping.c ****             debug_tapping_key();
 280:../../tmk_core/common/action_tapping.c ****             return true;
 281:../../tmk_core/common/action_tapping.c ****         } else {
 282:../../tmk_core/common/action_tapping.c ****             process_action(keyp);
 283:../../tmk_core/common/action_tapping.c ****             return true;
 284:../../tmk_core/common/action_tapping.c ****         }
 285:../../tmk_core/common/action_tapping.c ****     }
 286:../../tmk_core/common/action_tapping.c **** }
 287:../../tmk_core/common/action_tapping.c **** 
 288:../../tmk_core/common/action_tapping.c **** 
 289:../../tmk_core/common/action_tapping.c **** /*
 290:../../tmk_core/common/action_tapping.c ****  * Waiting buffer
 291:../../tmk_core/common/action_tapping.c ****  */
 292:../../tmk_core/common/action_tapping.c **** bool waiting_buffer_enq(keyrecord_t record)
 293:../../tmk_core/common/action_tapping.c **** {
 294:../../tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 295:../../tmk_core/common/action_tapping.c ****         return true;
 296:../../tmk_core/common/action_tapping.c ****     }
 297:../../tmk_core/common/action_tapping.c **** 
 298:../../tmk_core/common/action_tapping.c ****     if ((waiting_buffer_head + 1) % WAITING_BUFFER_SIZE == waiting_buffer_tail) {
 299:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 300:../../tmk_core/common/action_tapping.c ****         return false;
 301:../../tmk_core/common/action_tapping.c ****     }
 302:../../tmk_core/common/action_tapping.c **** 
 303:../../tmk_core/common/action_tapping.c ****     waiting_buffer[waiting_buffer_head] = record;
 304:../../tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 305:../../tmk_core/common/action_tapping.c **** 
 306:../../tmk_core/common/action_tapping.c ****     debug("waiting_buffer_enq: "); debug_waiting_buffer();
 307:../../tmk_core/common/action_tapping.c ****     return true;
 308:../../tmk_core/common/action_tapping.c **** }
 309:../../tmk_core/common/action_tapping.c **** 
 310:../../tmk_core/common/action_tapping.c **** void waiting_buffer_clear(void)
 311:../../tmk_core/common/action_tapping.c **** {
 312:../../tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 313:../../tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 314:../../tmk_core/common/action_tapping.c **** }
 315:../../tmk_core/common/action_tapping.c **** 
 316:../../tmk_core/common/action_tapping.c **** bool waiting_buffer_typed(keyevent_t event)
 317:../../tmk_core/common/action_tapping.c **** {
 318:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 319:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 320:../../tmk_core/common/action_tapping.c ****             return true;
 321:../../tmk_core/common/action_tapping.c ****         }
 322:../../tmk_core/common/action_tapping.c ****     }
 323:../../tmk_core/common/action_tapping.c ****     return false;
 324:../../tmk_core/common/action_tapping.c **** }
 325:../../tmk_core/common/action_tapping.c **** 
 326:../../tmk_core/common/action_tapping.c **** /* scan buffer for tapping */
 327:../../tmk_core/common/action_tapping.c **** void waiting_buffer_scan_tap(void)
 328:../../tmk_core/common/action_tapping.c **** {
 329:../../tmk_core/common/action_tapping.c ****     // tapping already is settled
 330:../../tmk_core/common/action_tapping.c ****     if (tapping_key.tap.count > 0) return;
 331:../../tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 332:../../tmk_core/common/action_tapping.c ****     if (!tapping_key.event.pressed) return;
 333:../../tmk_core/common/action_tapping.c **** 
 334:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 335:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 336:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 337:../../tmk_core/common/action_tapping.c ****                 WITHIN_TAPPING_TERM(waiting_buffer[i].event)) {
 338:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 339:../../tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 340:../../tmk_core/common/action_tapping.c ****             process_action(&tapping_key);
 341:../../tmk_core/common/action_tapping.c **** 
 342:../../tmk_core/common/action_tapping.c ****             debug("waiting_buffer_scan_tap: found at ["); debug_dec(i); debug("]\n");
 343:../../tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 344:../../tmk_core/common/action_tapping.c ****             return;
 345:../../tmk_core/common/action_tapping.c ****         }
 346:../../tmk_core/common/action_tapping.c ****     }
 347:../../tmk_core/common/action_tapping.c **** }
 348:../../tmk_core/common/action_tapping.c **** 
 349:../../tmk_core/common/action_tapping.c **** 
 350:../../tmk_core/common/action_tapping.c **** /*
 351:../../tmk_core/common/action_tapping.c ****  * debug print
 352:../../tmk_core/common/action_tapping.c ****  */
 353:../../tmk_core/common/action_tapping.c **** static void debug_tapping_key(void)
 354:../../tmk_core/common/action_tapping.c **** {
 355:../../tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
 356:../../tmk_core/common/action_tapping.c **** }
 357:../../tmk_core/common/action_tapping.c **** 
 358:../../tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void)
 359:../../tmk_core/common/action_tapping.c **** {
  15               		.loc 1 359 1 view -0
  16               		.cfi_startproc
  17 0000 1F93      		push r17
  18               	.LCFI0:
  19               		.cfi_def_cfa_offset 3
  20               		.cfi_offset 17, -2
  21 0002 CF93      		push r28
  22               	.LCFI1:
  23               		.cfi_def_cfa_offset 4
  24               		.cfi_offset 28, -3
  25 0004 DF93      		push r29
  26               	.LCFI2:
  27               		.cfi_def_cfa_offset 5
  28               		.cfi_offset 29, -4
  29               	/* prologue: function */
  30               	/* frame size = 0 */
  31               	/* stack size = 3 */
  32               	.L__stack_usage = 3
 360:../../tmk_core/common/action_tapping.c ****     debug("{ ");
  33               		.loc 1 360 5 view .LVU1
 361:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  34               		.loc 1 361 5 view .LVU2
  35               	.LBB3:
  36               		.loc 1 361 10 view .LVU3
  37               		.loc 1 361 18 is_stmt 0 view .LVU4
  38 0006 C091 0000 		lds r28,waiting_buffer_tail
  39               	.LVL0:
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  40               		.loc 1 362 48 view .LVU5
  41 000a 16E0      		ldi r17,lo8(6)
  42               	.LVL1:
  43               	.L2:
 361:../../tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  44               		.loc 1 361 5 discriminator 1 view .LVU6
  45 000c 8091 0000 		lds r24,waiting_buffer_head
  46 0010 8C13      		cpse r24,r28
  47 0012 00C0      		rjmp .L3
  48               	/* epilogue start */
  49               	.LBE3:
 363:../../tmk_core/common/action_tapping.c ****     }
 364:../../tmk_core/common/action_tapping.c ****     debug("}\n");
 365:../../tmk_core/common/action_tapping.c **** }
  50               		.loc 1 365 1 view .LVU7
  51 0014 DF91      		pop r29
  52 0016 CF91      		pop r28
  53               	.LVL2:
  54               		.loc 1 365 1 view .LVU8
  55 0018 1F91      		pop r17
  56 001a 0895      		ret
  57               	.LVL3:
  58               	.L3:
  59               	.LBB4:
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  60               		.loc 1 362 9 is_stmt 1 discriminator 3 view .LVU9
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  61               		.loc 1 362 21 discriminator 3 view .LVU10
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  62               		.loc 1 362 35 discriminator 3 view .LVU11
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  63               		.loc 1 362 48 discriminator 3 view .LVU12
  64 001c D0E0      		ldi r29,0
  65 001e 1C9F      		mul r17,r28
  66 0020 F001      		movw r30,r0
  67 0022 1D9F      		mul r17,r29
  68 0024 F00D      		add r31,r0
  69 0026 1124      		clr __zero_reg__
  70 0028 E050      		subi r30,lo8(-(waiting_buffer))
  71 002a F040      		sbci r31,hi8(-(waiting_buffer))
  72 002c 4081      		ld r20,Z
  73 002e 5181      		ldd r21,Z+1
  74 0030 6281      		ldd r22,Z+2
  75 0032 7381      		ldd r23,Z+3
  76 0034 8481      		ldd r24,Z+4
  77 0036 9581      		ldd r25,Z+5
  78 0038 0E94 0000 		call debug_record
  79               	.LVL4:
 362:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  80               		.loc 1 362 81 discriminator 3 view .LVU13
 361:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  81               		.loc 1 361 76 is_stmt 0 discriminator 3 view .LVU14
  82 003c 2196      		adiw r28,1
  83               	.LVL5:
 361:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  84               		.loc 1 361 71 discriminator 3 view .LVU15
  85 003e C770      		andi r28,lo8(7)
 361:../../tmk_core/common/action_tapping.c ****         debug("["); debug_dec(i); debug("]="); debug_record(waiting_buffer[i]); debug(" ");
  86               		.loc 1 361 71 discriminator 3 view .LVU16
  87 0040 00C0      		rjmp .L2
  88               	.LBE4:
  89               		.cfi_endproc
  90               	.LFE11:
  92               		.section	.text.debug_tapping_key,"ax",@progbits
  94               	debug_tapping_key:
  95               	.LFB10:
 354:../../tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY="); debug_record(tapping_key); debug("\n");
  96               		.loc 1 354 1 is_stmt 1 view -0
  97               		.cfi_startproc
  98               	/* prologue: function */
  99               	/* frame size = 0 */
 100               	/* stack size = 0 */
 101               	.L__stack_usage = 0
 355:../../tmk_core/common/action_tapping.c **** }
 102               		.loc 1 355 5 view .LVU18
 355:../../tmk_core/common/action_tapping.c **** }
 103               		.loc 1 355 28 view .LVU19
 104 0000 4091 0000 		lds r20,tapping_key
 105 0004 5091 0000 		lds r21,tapping_key+1
 106 0008 6091 0000 		lds r22,tapping_key+2
 107 000c 7091 0000 		lds r23,tapping_key+3
 108 0010 8091 0000 		lds r24,tapping_key+4
 109 0014 9091 0000 		lds r25,tapping_key+5
 110 0018 0C94 0000 		jmp debug_record
 111               	.LVL6:
 112               		.cfi_endproc
 113               	.LFE10:
 115               		.section	.text.waiting_buffer_scan_tap,"ax",@progbits
 117               	waiting_buffer_scan_tap:
 118               	.LFB9:
 328:../../tmk_core/common/action_tapping.c ****     // tapping already is settled
 119               		.loc 1 328 1 view -0
 120               		.cfi_startproc
 121 0000 1F93      		push r17
 122               	.LCFI3:
 123               		.cfi_def_cfa_offset 3
 124               		.cfi_offset 17, -2
 125 0002 CF93      		push r28
 126               	.LCFI4:
 127               		.cfi_def_cfa_offset 4
 128               		.cfi_offset 28, -3
 129 0004 DF93      		push r29
 130               	.LCFI5:
 131               		.cfi_def_cfa_offset 5
 132               		.cfi_offset 29, -4
 133               	/* prologue: function */
 134               	/* frame size = 0 */
 135               	/* stack size = 3 */
 136               	.L__stack_usage = 3
 330:../../tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 137               		.loc 1 330 5 view .LVU21
 330:../../tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 138               		.loc 1 330 31 is_stmt 0 view .LVU22
 139 0006 8091 0000 		lds r24,tapping_key+5
 140 000a 807F      		andi r24,lo8(-16)
 330:../../tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 141               		.loc 1 330 8 view .LVU23
 142 000c 01F4      		brne .L5
 332:../../tmk_core/common/action_tapping.c **** 
 143               		.loc 1 332 5 is_stmt 1 view .LVU24
 332:../../tmk_core/common/action_tapping.c **** 
 144               		.loc 1 332 8 is_stmt 0 view .LVU25
 145 000e 8091 0000 		lds r24,tapping_key+2
 146 0012 8823      		tst r24
 147 0014 01F0      		breq .L5
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 148               		.loc 1 334 5 is_stmt 1 view .LVU26
 149               	.LBB8:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 150               		.loc 1 334 10 view .LVU27
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 151               		.loc 1 334 18 is_stmt 0 view .LVU28
 152 0016 8091 0000 		lds r24,waiting_buffer_tail
 153               	.LVL7:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 154               		.loc 1 334 45 view .LVU29
 155 001a C091 0000 		lds r28,waiting_buffer_head
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 156               		.loc 1 335 13 view .LVU30
 157 001e 6091 0000 		lds r22,tapping_key
 158 0022 7091 0000 		lds r23,tapping_key+1
 159 0026 4091 0000 		lds r20,tapping_key+3
 160 002a 5091 0000 		lds r21,tapping_key+3+1
 161 002e D62F      		mov r29,r22
 162 0030 D723      		and r29,r23
 163 0032 DA01      		movw r26,r20
 164 0034 A095      		com r26
 165 0036 B095      		com r27
 166 0038 16E0      		ldi r17,lo8(6)
 167               	.LVL8:
 168               	.L7:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 169               		.loc 1 334 5 discriminator 1 view .LVU31
 170 003a C813      		cpse r28,r24
 171 003c 00C0      		rjmp .L14
 172               	.LVL9:
 173               	.L5:
 174               	/* epilogue start */
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 175               		.loc 1 334 5 discriminator 1 view .LVU32
 176               	.LBE8:
 347:../../tmk_core/common/action_tapping.c **** 
 177               		.loc 1 347 1 view .LVU33
 178 003e DF91      		pop r29
 179 0040 CF91      		pop r28
 180 0042 1F91      		pop r17
 181 0044 0895      		ret
 182               	.LVL10:
 183               	.L14:
 184               	.LBB11:
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 185               		.loc 1 335 9 is_stmt 1 view .LVU34
 186               	.LBB9:
 187               	.LBI9:
 188               		.file 2 "../../tmk_core/common/keyboard.h"
   1:../../tmk_core/common/keyboard.h **** /*
   2:../../tmk_core/common/keyboard.h **** Copyright 2011,2012,2013 Jun Wako <wakojun@gmail.com>
   3:../../tmk_core/common/keyboard.h **** 
   4:../../tmk_core/common/keyboard.h **** This program is free software: you can redistribute it and/or modify
   5:../../tmk_core/common/keyboard.h **** it under the terms of the GNU General Public License as published by
   6:../../tmk_core/common/keyboard.h **** the Free Software Foundation, either version 2 of the License, or
   7:../../tmk_core/common/keyboard.h **** (at your option) any later version.
   8:../../tmk_core/common/keyboard.h **** 
   9:../../tmk_core/common/keyboard.h **** This program is distributed in the hope that it will be useful,
  10:../../tmk_core/common/keyboard.h **** but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:../../tmk_core/common/keyboard.h **** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:../../tmk_core/common/keyboard.h **** GNU General Public License for more details.
  13:../../tmk_core/common/keyboard.h **** 
  14:../../tmk_core/common/keyboard.h **** You should have received a copy of the GNU General Public License
  15:../../tmk_core/common/keyboard.h **** along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:../../tmk_core/common/keyboard.h **** */
  17:../../tmk_core/common/keyboard.h **** 
  18:../../tmk_core/common/keyboard.h **** #ifndef KEYBOARD_H
  19:../../tmk_core/common/keyboard.h **** #define KEYBOARD_H
  20:../../tmk_core/common/keyboard.h **** 
  21:../../tmk_core/common/keyboard.h **** #include <stdbool.h>
  22:../../tmk_core/common/keyboard.h **** #include <stdint.h>
  23:../../tmk_core/common/keyboard.h **** 
  24:../../tmk_core/common/keyboard.h **** 
  25:../../tmk_core/common/keyboard.h **** #ifdef __cplusplus
  26:../../tmk_core/common/keyboard.h **** extern "C" {
  27:../../tmk_core/common/keyboard.h **** #endif
  28:../../tmk_core/common/keyboard.h **** 
  29:../../tmk_core/common/keyboard.h **** /* key matrix position */
  30:../../tmk_core/common/keyboard.h **** typedef struct {
  31:../../tmk_core/common/keyboard.h ****     uint8_t col;
  32:../../tmk_core/common/keyboard.h ****     uint8_t row;
  33:../../tmk_core/common/keyboard.h **** } keypos_t;
  34:../../tmk_core/common/keyboard.h **** 
  35:../../tmk_core/common/keyboard.h **** /* key event */
  36:../../tmk_core/common/keyboard.h **** typedef struct {
  37:../../tmk_core/common/keyboard.h ****     keypos_t key;
  38:../../tmk_core/common/keyboard.h ****     bool     pressed;
  39:../../tmk_core/common/keyboard.h ****     uint16_t time;
  40:../../tmk_core/common/keyboard.h **** } keyevent_t;
  41:../../tmk_core/common/keyboard.h **** 
  42:../../tmk_core/common/keyboard.h **** /* equivalent test of keypos_t */
  43:../../tmk_core/common/keyboard.h **** #define KEYEQ(keya, keyb)       ((keya).row == (keyb).row && (keya).col == (keyb).col)
  44:../../tmk_core/common/keyboard.h **** 
  45:../../tmk_core/common/keyboard.h **** /* Rules for No Event:
  46:../../tmk_core/common/keyboard.h ****  * 1) (time == 0) to handle (keyevent_t){} as empty event
  47:../../tmk_core/common/keyboard.h ****  * 2) Matrix(255, 255) to make TICK event available
  48:../../tmk_core/common/keyboard.h ****  */
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_NOEVENT(keyevent_t event) { return event.time == 0 || (event.key.row == 255 &
 189               		.loc 2 49 20 view .LVU35
 190               	.LBB10:
 191               		.loc 2 49 51 view .LVU36
 192 0046 90E0      		ldi r25,0
 193               		.loc 2 49 74 is_stmt 0 view .LVU37
 194 0048 4115      		cp r20,__zero_reg__
 195 004a 5105      		cpc r21,__zero_reg__
 196 004c 01F0      		breq .L8
 197 004e DF3F      		cpi r29,lo8(-1)
 198 0050 01F4      		brne .L27
 199               	.L8:
 200               	.LBE10:
 201               	.LBE9:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 202               		.loc 1 334 76 discriminator 2 view .LVU38
 203 0052 0196      		adiw r24,1
 204               	.LVL11:
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 205               		.loc 1 334 71 discriminator 2 view .LVU39
 206 0054 8770      		andi r24,lo8(7)
 334:../../tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) &&
 207               		.loc 1 334 71 discriminator 2 view .LVU40
 208 0056 00C0      		rjmp .L7
 209               	.LVL12:
 210               	.L10:
 337:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 211               		.loc 1 337 17 discriminator 2 view .LVU41
 212 0058 2A0F      		add r18,r26
 213 005a 3B1F      		adc r19,r27
 214 005c 00C0      		rjmp .L28
 215               	.L27:
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 216               		.loc 1 335 13 view .LVU42
 217 005e 189F      		mul r17,r24
 218 0060 F001      		movw r30,r0
 219 0062 199F      		mul r17,r25
 220 0064 F00D      		add r31,r0
 221 0066 1124      		clr __zero_reg__
 222 0068 E050      		subi r30,lo8(-(waiting_buffer))
 223 006a F040      		sbci r31,hi8(-(waiting_buffer))
 224 006c 2181      		ldd r18,Z+1
 225 006e 2713      		cpse r18,r23
 226 0070 00C0      		rjmp .L8
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 227               		.loc 1 335 13 discriminator 2 view .LVU43
 228 0072 2081      		ld r18,Z
 229 0074 2613      		cpse r18,r22
 230 0076 00C0      		rjmp .L8
 335:../../tmk_core/common/action_tapping.c ****                 !waiting_buffer[i].event.pressed &&
 231               		.loc 1 335 57 discriminator 3 view .LVU44
 232 0078 2281      		ldd r18,Z+2
 233 007a 2111      		cpse r18,__zero_reg__
 234 007c 00C0      		rjmp .L8
 337:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 235               		.loc 1 337 17 view .LVU45
 236 007e 2381      		ldd r18,Z+3
 237 0080 3481      		ldd r19,Z+4
 238 0082 2417      		cp r18,r20
 239 0084 3507      		cpc r19,r21
 240 0086 00F0      		brlo .L10
 337:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 241               		.loc 1 337 17 discriminator 1 view .LVU46
 242 0088 241B      		sub r18,r20
 243 008a 350B      		sbc r19,r21
 244               	.L28:
 337:../../tmk_core/common/action_tapping.c ****             tapping_key.tap.count = 1;
 245               		.loc 1 337 17 discriminator 2 view .LVU47
 246 008c 2C32      		cpi r18,44
 247 008e 3140      		sbci r19,1
 248 0090 00F4      		brsh .L8
 338:../../tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 249               		.loc 1 338 13 is_stmt 1 view .LVU48
 338:../../tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 250               		.loc 1 338 35 is_stmt 0 view .LVU49
 251 0092 2091 0000 		lds r18,tapping_key+5
 252 0096 2F70      		andi r18,lo8(15)
 253 0098 2061      		ori r18,lo8(16)
 254 009a 2093 0000 		sts tapping_key+5,r18
 339:../../tmk_core/common/action_tapping.c ****             process_action(&tapping_key);
 255               		.loc 1 339 13 is_stmt 1 view .LVU50
 339:../../tmk_core/common/action_tapping.c ****             process_action(&tapping_key);
 256               		.loc 1 339 41 is_stmt 0 view .LVU51
 257 009e 26E0      		ldi r18,lo8(6)
 258 00a0 289F      		mul r18,r24
 259 00a2 F001      		movw r30,r0
 260 00a4 299F      		mul r18,r25
 261 00a6 F00D      		add r31,r0
 262 00a8 1124      		clr __zero_reg__
 263 00aa E050      		subi r30,lo8(-(waiting_buffer+5))
 264 00ac F040      		sbci r31,hi8(-(waiting_buffer+5))
 265 00ae 8081      		ld r24,Z
 266               	.LVL13:
 339:../../tmk_core/common/action_tapping.c ****             process_action(&tapping_key);
 267               		.loc 1 339 41 view .LVU52
 268 00b0 8F70      		andi r24,lo8(15)
 269 00b2 8061      		ori r24,lo8(16)
 270 00b4 8083      		st Z,r24
 340:../../tmk_core/common/action_tapping.c **** 
 271               		.loc 1 340 13 is_stmt 1 view .LVU53
 272 00b6 80E0      		ldi r24,lo8(tapping_key)
 273 00b8 90E0      		ldi r25,hi8(tapping_key)
 274 00ba 0E94 0000 		call process_action
 275               	.LVL14:
 342:../../tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 276               		.loc 1 342 13 view .LVU54
 342:../../tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 277               		.loc 1 342 59 view .LVU55
 342:../../tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 278               		.loc 1 342 73 view .LVU56
 343:../../tmk_core/common/action_tapping.c ****             return;
 279               		.loc 1 343 13 view .LVU57
 280               	/* epilogue start */
 281               	.LBE11:
 347:../../tmk_core/common/action_tapping.c **** 
 282               		.loc 1 347 1 is_stmt 0 view .LVU58
 283 00be DF91      		pop r29
 284 00c0 CF91      		pop r28
 285 00c2 1F91      		pop r17
 286               	.LBB12:
 343:../../tmk_core/common/action_tapping.c ****             return;
 287               		.loc 1 343 13 view .LVU59
 288 00c4 0C94 0000 		jmp debug_waiting_buffer
 289               	.LVL15:
 290               	.LBE12:
 291               		.cfi_endproc
 292               	.LFE9:
 294               		.section	.text.process_tapping,"ax",@progbits
 296               	process_tapping:
 297               	.LVL16:
 298               	.LFB5:
  79:../../tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 299               		.loc 1 79 1 is_stmt 1 view -0
 300               		.cfi_startproc
  79:../../tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 301               		.loc 1 79 1 is_stmt 0 view .LVU61
 302 0000 BF92      		push r11
 303               	.LCFI6:
 304               		.cfi_def_cfa_offset 3
 305               		.cfi_offset 11, -2
 306 0002 CF92      		push r12
 307               	.LCFI7:
 308               		.cfi_def_cfa_offset 4
 309               		.cfi_offset 12, -3
 310 0004 DF92      		push r13
 311               	.LCFI8:
 312               		.cfi_def_cfa_offset 5
 313               		.cfi_offset 13, -4
 314 0006 EF92      		push r14
 315               	.LCFI9:
 316               		.cfi_def_cfa_offset 6
 317               		.cfi_offset 14, -5
 318 0008 FF92      		push r15
 319               	.LCFI10:
 320               		.cfi_def_cfa_offset 7
 321               		.cfi_offset 15, -6
 322 000a 0F93      		push r16
 323               	.LCFI11:
 324               		.cfi_def_cfa_offset 8
 325               		.cfi_offset 16, -7
 326 000c 1F93      		push r17
 327               	.LCFI12:
 328               		.cfi_def_cfa_offset 9
 329               		.cfi_offset 17, -8
 330 000e CF93      		push r28
 331               	.LCFI13:
 332               		.cfi_def_cfa_offset 10
 333               		.cfi_offset 28, -9
 334 0010 DF93      		push r29
 335               	.LCFI14:
 336               		.cfi_def_cfa_offset 11
 337               		.cfi_offset 29, -10
 338 0012 CDB7      		in r28,__SP_L__
 339 0014 DEB7      		in r29,__SP_H__
 340               	.LCFI15:
 341               		.cfi_def_cfa_register 28
 342 0016 6197      		sbiw r28,17
 343               	.LCFI16:
 344               		.cfi_def_cfa_offset 28
 345 0018 0FB6      		in __tmp_reg__,__SREG__
 346 001a F894      		cli
 347 001c DEBF      		out __SP_H__,r29
 348 001e 0FBE      		out __SREG__,__tmp_reg__
 349 0020 CDBF      		out __SP_L__,r28
 350               	/* prologue: function */
 351               	/* frame size = 17 */
 352               	/* stack size = 26 */
 353               	.L__stack_usage = 26
 354 0022 6C01      		movw r12,r24
  80:../../tmk_core/common/action_tapping.c **** 
 355               		.loc 1 80 5 is_stmt 1 view .LVU62
  80:../../tmk_core/common/action_tapping.c **** 
 356               		.loc 1 80 16 is_stmt 0 view .LVU63
 357 0024 85E0      		ldi r24,lo8(5)
 358               	.LVL17:
  80:../../tmk_core/common/action_tapping.c **** 
 359               		.loc 1 80 16 view .LVU64
 360 0026 F601      		movw r30,r12
 361 0028 DE01      		movw r26,r28
 362 002a 1D96      		adiw r26,13
 363               		0:
 364 002c 0190      		ld r0,Z+
 365 002e 0D92      		st X+,r0
 366 0030 8A95      		dec r24
 367 0032 01F4      		brne 0b
 368 0034 D601      		movw r26,r12
 369 0036 4C91      		ld r20,X
 370               	.LVL18:
  80:../../tmk_core/common/action_tapping.c **** 
 371               		.loc 1 80 16 view .LVU65
 372 0038 1196      		adiw r26,1
 373 003a 5C91      		ld r21,X
 374 003c 1197      		sbiw r26,1
 375               	.LVL19:
  80:../../tmk_core/common/action_tapping.c **** 
 376               		.loc 1 80 16 view .LVU66
 377 003e 1296      		adiw r26,2
 378 0040 FC90      		ld r15,X
 379 0042 1297      		sbiw r26,2
 380               	.LVL20:
  80:../../tmk_core/common/action_tapping.c **** 
 381               		.loc 1 80 16 view .LVU67
 382 0044 1396      		adiw r26,3
 383 0046 0D91      		ld r16,X+
 384 0048 1C91      		ld r17,X
 385               	.LVL21:
  83:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 386               		.loc 1 83 5 is_stmt 1 view .LVU68
  83:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 387               		.loc 1 83 9 is_stmt 0 view .LVU69
 388 004a 8091 0000 		lds r24,tapping_key+3
 389 004e 9091 0000 		lds r25,tapping_key+3+1
 390               	.LBB23:
 391               	.LBI23:
 392               		.loc 2 49 20 is_stmt 1 view .LVU70
 393               	.LBB24:
 394               		.loc 2 49 51 view .LVU71
 395               		.loc 2 49 74 is_stmt 0 view .LVU72
 396 0052 0097      		sbiw r24,0
 397 0054 01F4      		brne .+2
 398 0056 00C0      		rjmp .L30
 399               	.LBE24:
 400               	.LBE23:
  83:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 401               		.loc 1 83 9 view .LVU73
 402 0058 2091 0000 		lds r18,tapping_key
 403 005c 3091 0000 		lds r19,tapping_key+1
 404               	.LBB26:
 405               	.LBB25:
 406               		.loc 2 49 74 view .LVU74
 407 0060 622F      		mov r22,r18
 408 0062 6323      		and r22,r19
 409 0064 6F3F      		cpi r22,lo8(-1)
 410 0066 01F4      		brne .+2
 411 0068 00C0      		rjmp .L30
 412               	.LBE25:
 413               	.LBE26:
  83:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 414               		.loc 1 83 9 discriminator 1 view .LVU75
 415 006a B090 0000 		lds r11,tapping_key+2
 416 006e BB20      		tst r11
 417 0070 01F4      		brne .+2
 418 0072 00C0      		rjmp .L31
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 419               		.loc 1 84 9 is_stmt 1 view .LVU76
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 420               		.loc 1 84 13 is_stmt 0 view .LVU77
 421 0074 0817      		cp r16,r24
 422 0076 1907      		cpc r17,r25
 423 0078 00F0      		brlo .L32
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 424               		.loc 1 84 13 discriminator 1 view .LVU78
 425 007a F801      		movw r30,r16
 426 007c E81B      		sub r30,r24
 427 007e F90B      		sbc r31,r25
 428 0080 CF01      		movw r24,r30
 429 0082 EE24      		clr r14
 430 0084 E394      		inc r14
 431 0086 8C32      		cpi r24,44
 432 0088 9140      		sbci r25,1
 433 008a 00F0      		brlo .L34
 434               	.L119:
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 435               		.loc 1 84 13 discriminator 2 view .LVU79
 436 008c E12C      		mov r14,__zero_reg__
 437 008e 00C0      		rjmp .L34
 438               	.L32:
 439 0090 8095      		com r24
 440 0092 9095      		com r25
 441 0094 800F      		add r24,r16
 442 0096 911F      		adc r25,r17
 443 0098 EE24      		clr r14
 444 009a E394      		inc r14
 445 009c 8C32      		cpi r24,44
 446 009e 9140      		sbci r25,1
 447 00a0 00F4      		brsh .L119
 448               	.L34:
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 449               		.loc 1 84 13 discriminator 2 view .LVU80
 450 00a2 8091 0000 		lds r24,tapping_key+5
 451 00a6 982F      		mov r25,r24
 452 00a8 907F      		andi r25,lo8(-16)
  84:../../tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 453               		.loc 1 84 12 discriminator 4 view .LVU81
 454 00aa EE20      		tst r14
 455 00ac 01F4      		brne .+2
 456 00ae 00C0      		rjmp .L36
  85:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 457               		.loc 1 85 13 is_stmt 1 view .LVU82
  85:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 458               		.loc 1 85 16 is_stmt 0 view .LVU83
 459 00b0 9111      		cpse r25,__zero_reg__
 460 00b2 00C0      		rjmp .L37
  86:../../tmk_core/common/action_tapping.c ****                     // first tap!
 461               		.loc 1 86 17 is_stmt 1 discriminator 1 view .LVU84
 462 00b4 EF2C      		mov r14,r15
  86:../../tmk_core/common/action_tapping.c ****                     // first tap!
 463               		.loc 1 86 21 is_stmt 0 discriminator 1 view .LVU85
 464 00b6 3513      		cpse r19,r21
 465 00b8 00C0      		rjmp .L38
 466               	.LVL22:
  86:../../tmk_core/common/action_tapping.c ****                     // first tap!
 467               		.loc 1 86 21 discriminator 2 view .LVU86
 468 00ba 2413      		cpse r18,r20
 469 00bc 00C0      		rjmp .L38
  86:../../tmk_core/common/action_tapping.c ****                     // first tap!
 470               		.loc 1 86 47 discriminator 3 view .LVU87
 471 00be F110      		cpse r15,__zero_reg__
 472 00c0 00C0      		rjmp .L38
  88:../../tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 473               		.loc 1 88 21 is_stmt 1 view .LVU88
  89:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 474               		.loc 1 89 21 view .LVU89
  89:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 475               		.loc 1 89 43 is_stmt 0 view .LVU90
 476 00c2 8F70      		andi r24,lo8(15)
 477 00c4 8061      		ori r24,lo8(16)
 478 00c6 8093 0000 		sts tapping_key+5,r24
  90:../../tmk_core/common/action_tapping.c ****                     process_action(&tapping_key);
 479               		.loc 1 90 21 is_stmt 1 view .LVU91
 480 00ca 0E94 0000 		call debug_tapping_key
 481               	.LVL23:
  91:../../tmk_core/common/action_tapping.c **** 
 482               		.loc 1 91 21 view .LVU92
 483 00ce 80E0      		ldi r24,lo8(tapping_key)
 484 00d0 90E0      		ldi r25,hi8(tapping_key)
 485 00d2 0E94 0000 		call process_action
 486               	.LVL24:
  94:../../tmk_core/common/action_tapping.c ****                     // enqueue
 487               		.loc 1 94 21 view .LVU93
  94:../../tmk_core/common/action_tapping.c ****                     // enqueue
 488               		.loc 1 94 31 is_stmt 0 view .LVU94
 489 00d6 8091 0000 		lds r24,tapping_key+5
 490 00da D601      		movw r26,r12
 491 00dc 1596      		adiw r26,5
 492 00de 8C93      		st X,r24
  96:../../tmk_core/common/action_tapping.c ****                 }
 493               		.loc 1 96 21 is_stmt 1 view .LVU95
 494               	.LVL25:
 495               	.L29:
 286:../../tmk_core/common/action_tapping.c **** 
 496               		.loc 1 286 1 is_stmt 0 view .LVU96
 497 00e0 8E2D      		mov r24,r14
 498               	/* epilogue start */
 286:../../tmk_core/common/action_tapping.c **** 
 499               		.loc 1 286 1 view .LVU97
 500 00e2 6196      		adiw r28,17
 501 00e4 0FB6      		in __tmp_reg__,__SREG__
 502 00e6 F894      		cli
 503 00e8 DEBF      		out __SP_H__,r29
 504 00ea 0FBE      		out __SREG__,__tmp_reg__
 505 00ec CDBF      		out __SP_L__,r28
 506 00ee DF91      		pop r29
 507 00f0 CF91      		pop r28
 508 00f2 1F91      		pop r17
 509 00f4 0F91      		pop r16
 510               	.LVL26:
 286:../../tmk_core/common/action_tapping.c **** 
 511               		.loc 1 286 1 view .LVU98
 512 00f6 FF90      		pop r15
 513               	.LVL27:
 286:../../tmk_core/common/action_tapping.c **** 
 514               		.loc 1 286 1 view .LVU99
 515 00f8 EF90      		pop r14
 516 00fa DF90      		pop r13
 517 00fc CF90      		pop r12
 518               	.LVL28:
 286:../../tmk_core/common/action_tapping.c **** 
 519               		.loc 1 286 1 view .LVU100
 520 00fe BF90      		pop r11
 521 0100 0895      		ret
 522               	.LVL29:
 523               	.L38:
 116:../../tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 524               		.loc 1 116 22 is_stmt 1 view .LVU101
 525               	.LBB27:
 526               	.LBI27:
  50:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
  51:../../tmk_core/common/keyboard.h **** static inline bool IS_RELEASED(keyevent_t event) { return (!IS_NOEVENT(event) && !event.pressed); }
 527               		.loc 2 51 20 view .LVU102
 528               	.LBB28:
 529               		.loc 2 51 52 view .LVU103
 530               	.LBB29:
 531               	.LBI29:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 532               		.loc 2 49 20 view .LVU104
 533               	.LBB30:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 534               		.loc 2 49 51 view .LVU105
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 535               		.loc 2 49 74 is_stmt 0 view .LVU106
 536 0102 0115      		cp r16,__zero_reg__
 537 0104 1105      		cpc r17,__zero_reg__
 538 0106 01F0      		breq .L69
 539 0108 852F      		mov r24,r21
 540 010a 8423      		and r24,r20
 541 010c 8F3F      		cpi r24,lo8(-1)
 542 010e 01F0      		breq .+2
 543 0110 00C0      		rjmp .L41
 544               	.L69:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 545               		.loc 2 49 74 view .LVU107
 546               	.LBE30:
 547               	.LBE29:
 548               		.loc 2 51 79 view .LVU108
 549 0112 80E0      		ldi r24,0
 550               	.L40:
 551               	.LVL30:
 552               		.loc 2 51 79 view .LVU109
 553               	.LBE28:
 554               	.LBE27:
 116:../../tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 555               		.loc 1 116 25 view .LVU110
 556 0114 B82F      		mov r27,r24
 557 0116 B170      		andi r27,lo8(1)
 558 0118 BB2E      		mov r11,r27
 559 011a 80FF      		sbrs r24,0
 560 011c 00C0      		rjmp .L42
 561               	.LBB32:
 562               	.LBI32:
 316:../../tmk_core/common/action_tapping.c **** {
 563               		.loc 1 316 6 is_stmt 1 discriminator 1 view .LVU111
 564               	.LBE32:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 565               		.loc 1 318 5 discriminator 1 view .LVU112
 566               	.LBB35:
 567               	.LBB33:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 568               		.loc 1 318 10 discriminator 1 view .LVU113
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 569               		.loc 1 318 18 is_stmt 0 discriminator 1 view .LVU114
 570 011e 8091 0000 		lds r24,waiting_buffer_tail
 571               	.LVL31:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 572               		.loc 1 318 45 discriminator 1 view .LVU115
 573 0122 2091 0000 		lds r18,waiting_buffer_head
 319:../../tmk_core/common/action_tapping.c ****             return true;
 574               		.loc 1 319 13 discriminator 1 view .LVU116
 575 0126 36E0      		ldi r19,lo8(6)
 576               	.LVL32:
 577               	.L43:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 578               		.loc 1 318 5 view .LVU117
 579 0128 8213      		cpse r24,r18
 580 012a 00C0      		rjmp .L45
 581               	.LVL33:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 582               		.loc 1 318 5 view .LVU118
 583               	.LBE33:
 584               	.LBE35:
 585               	.LBB36:
 118:../../tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 586               		.loc 1 118 21 is_stmt 1 view .LVU119
 118:../../tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 587               		.loc 1 118 39 is_stmt 0 view .LVU120
 588 012c 702F      		mov r23,r16
 589 012e 198B      		std Y+17,r17
 590 0130 088B      		std Y+16,r16
 591 0132 6F2D      		mov r22,r15
 592 0134 8989      		ldd r24,Y+17
 593 0136 0E94 0000 		call layer_switch_get_action
 594               	.LVL34:
 119:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 595               		.loc 1 119 21 is_stmt 1 view .LVU121
 119:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 596               		.loc 1 119 40 is_stmt 0 view .LVU122
 597 013a 292F      		mov r18,r25
 598 013c 2295      		swap r18
 599 013e 2F70      		andi r18,lo8(15)
 600 0140 2230      		cpi r18,lo8(2)
 601 0142 00F0      		brlo .L67
 119:../../tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 602               		.loc 1 119 40 view .LVU123
 603 0144 2430      		cpi r18,lo8(4)
 604 0146 00F4      		brsh .L49
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 605               		.loc 1 127 29 is_stmt 1 view .LVU124
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 606               		.loc 1 127 33 is_stmt 0 view .LVU125
 607 0148 9F70      		andi r25,lo8(15)
 608               	.LVL35:
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 609               		.loc 1 127 32 view .LVU126
 610 014a 01F0      		breq .L50
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 611               		.loc 1 127 68 discriminator 1 view .LVU127
 612 014c F601      		movw r30,r12
 613 014e 9581      		ldd r25,Z+5
 614 0150 907F      		andi r25,lo8(-16)
 127:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 615               		.loc 1 127 49 discriminator 1 view .LVU128
 616 0152 01F4      		brne .L50
 617               	.LVL36:
 618               	.L73:
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 619               		.loc 1 122 77 view .LVU129
 620 0154 B12C      		mov r11,__zero_reg__
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 621               		.loc 1 122 77 view .LVU130
 622 0156 00C0      		rjmp .L122
 623               	.LVL37:
 624               	.L45:
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 625               		.loc 1 122 77 view .LVU131
 626               	.LBE36:
 627               	.LBB37:
 628               	.LBB34:
 319:../../tmk_core/common/action_tapping.c ****             return true;
 629               		.loc 1 319 9 is_stmt 1 view .LVU132
 319:../../tmk_core/common/action_tapping.c ****             return true;
 630               		.loc 1 319 13 is_stmt 0 view .LVU133
 631 0158 90E0      		ldi r25,0
 632 015a 389F      		mul r19,r24
 633 015c F001      		movw r30,r0
 634 015e 399F      		mul r19,r25
 635 0160 F00D      		add r31,r0
 636 0162 1124      		clr __zero_reg__
 637 0164 E050      		subi r30,lo8(-(waiting_buffer))
 638 0166 F040      		sbci r31,hi8(-(waiting_buffer))
 319:../../tmk_core/common/action_tapping.c ****             return true;
 639               		.loc 1 319 12 view .LVU134
 640 0168 6181      		ldd r22,Z+1
 641 016a 6513      		cpse r22,r21
 642 016c 00C0      		rjmp .L44
 319:../../tmk_core/common/action_tapping.c ****             return true;
 643               		.loc 1 319 13 view .LVU135
 644 016e 6081      		ld r22,Z
 645 0170 6413      		cpse r22,r20
 646 0172 00C0      		rjmp .L44
 319:../../tmk_core/common/action_tapping.c ****             return true;
 647               		.loc 1 319 59 view .LVU136
 648 0174 6281      		ldd r22,Z+2
 649 0176 F612      		cpse r15,r22
 650 0178 00C0      		rjmp .L42
 651               	.L44:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 652               		.loc 1 318 76 view .LVU137
 653 017a 0196      		adiw r24,1
 654               	.LVL38:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 655               		.loc 1 318 71 view .LVU138
 656 017c 8770      		andi r24,lo8(7)
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 657               		.loc 1 318 71 view .LVU139
 658 017e 00C0      		rjmp .L43
 659               	.LVL39:
 660               	.L67:
 318:../../tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed !=  waiting_buffer[i].ev
 661               		.loc 1 318 71 view .LVU140
 662               	.LBE34:
 663               	.LBE37:
 664               	.LBB38:
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 665               		.loc 1 122 29 is_stmt 1 view .LVU141
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 666               		.loc 1 122 33 is_stmt 0 view .LVU142
 667 0180 9F70      		andi r25,lo8(15)
 668               	.LVL40:
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 669               		.loc 1 122 32 view .LVU143
 670 0182 01F0      		breq .L50
 122:../../tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 671               		.loc 1 122 49 discriminator 1 view .LVU144
 672 0184 8823      		tst r24
 673 0186 01F0      		breq .L73
 674               	.L50:
 128:../../tmk_core/common/action_tapping.c ****                             break;
 675               		.loc 1 128 29 is_stmt 1 view .LVU145
 128:../../tmk_core/common/action_tapping.c ****                             break;
 676               		.loc 1 128 33 is_stmt 0 view .LVU146
 677 0188 805E      		subi r24,lo8(-(32))
 678               	.LVL41:
 128:../../tmk_core/common/action_tapping.c ****                             break;
 679               		.loc 1 128 32 view .LVU147
 680 018a 8830      		cpi r24,lo8(8)
 681 018c 00F0      		brlo .L73
 682               	.LVL42:
 683               	.L49:
 132:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 684               		.loc 1 132 21 is_stmt 1 view .LVU148
 133:../../tmk_core/common/action_tapping.c ****                     return true;
 685               		.loc 1 133 21 view .LVU149
 686 018e C601      		movw r24,r12
 687               	.LVL43:
 133:../../tmk_core/common/action_tapping.c ****                     return true;
 688               		.loc 1 133 21 is_stmt 0 view .LVU150
 689 0190 0E94 0000 		call process_action
 690               	.LVL44:
 134:../../tmk_core/common/action_tapping.c ****                 }
 691               		.loc 1 134 21 is_stmt 1 view .LVU151
 692               	.L122:
 134:../../tmk_core/common/action_tapping.c ****                 }
 693               		.loc 1 134 21 is_stmt 0 view .LVU152
 694               	.LBE38:
 197:../../tmk_core/common/action_tapping.c ****                 }
 695               		.loc 1 197 21 is_stmt 1 view .LVU153
 197:../../tmk_core/common/action_tapping.c ****                 }
 696               		.loc 1 197 28 is_stmt 0 view .LVU154
 697 0194 EB2C      		mov r14,r11
 698 0196 00C0      		rjmp .L29
 699               	.LVL45:
 700               	.L42:
 138:../../tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 701               		.loc 1 138 21 is_stmt 1 view .LVU155
 138:../../tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 702               		.loc 1 138 24 is_stmt 0 view .LVU156
 703 0198 FF20      		tst r15
 704 019a 01F4      		brne .+2
 705 019c 00C0      		rjmp .L29
 139:../../tmk_core/common/action_tapping.c ****                     }
 706               		.loc 1 139 25 is_stmt 1 view .LVU157
 139:../../tmk_core/common/action_tapping.c ****                     }
 707               		.loc 1 139 53 is_stmt 0 view .LVU158
 708 019e 8091 0000 		lds r24,tapping_key+5
 709 01a2 8160      		ori r24,lo8(1<<0)
 710 01a4 8093 0000 		sts tapping_key+5,r24
 142:../../tmk_core/common/action_tapping.c ****                 }
 711               		.loc 1 142 28 view .LVU159
 712 01a8 E12C      		mov r14,__zero_reg__
 713               	.LVL46:
 142:../../tmk_core/common/action_tapping.c ****                 }
 714               		.loc 1 142 28 view .LVU160
 715 01aa 00C0      		rjmp .L29
 716               	.LVL47:
 717               	.L37:
 147:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 718               		.loc 1 147 17 is_stmt 1 discriminator 1 view .LVU161
 147:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 719               		.loc 1 147 21 is_stmt 0 discriminator 1 view .LVU162
 720 01ac 3513      		cpse r19,r21
 721 01ae 00C0      		rjmp .L51
 147:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 722               		.loc 1 147 21 discriminator 2 view .LVU163
 723 01b0 2413      		cpse r18,r20
 724 01b2 00C0      		rjmp .L51
 149:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 725               		.loc 1 149 31 discriminator 3 view .LVU164
 726 01b4 D601      		movw r26,r12
 147:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release("); debug_dec(tapping_key.tap.count); debug(")\n");
 727               		.loc 1 147 47 discriminator 3 view .LVU165
 728 01b6 FF20      		tst r15
 729 01b8 01F4      		brne .+2
 730 01ba 00C0      		rjmp .L126
 731               	.L51:
 155:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 732               		.loc 1 155 22 is_stmt 1 view .LVU166
 155:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 733               		.loc 1 155 26 is_stmt 0 view .LVU167
 734 01bc 4D87      		std Y+13,r20
 735 01be 5E87      		std Y+14,r21
 736 01c0 FF86      		std Y+15,r15
 737 01c2 702F      		mov r23,r16
 738 01c4 198B      		std Y+17,r17
 739 01c6 088B      		std Y+16,r16
 740 01c8 6F2D      		mov r22,r15
 741 01ca 8989      		ldd r24,Y+17
 742 01cc 0E94 0000 		call is_tap_key
 743               	.LVL48:
 155:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 744               		.loc 1 155 25 view .LVU168
 745 01d0 8823      		tst r24
 746 01d2 01F4      		brne .+2
 747 01d4 00C0      		rjmp .L63
 155:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 748               		.loc 1 155 44 discriminator 1 view .LVU169
 749 01d6 FF20      		tst r15
 750 01d8 01F4      		brne .+2
 751 01da 00C0      		rjmp .L63
 156:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 752               		.loc 1 156 21 is_stmt 1 view .LVU170
 156:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 753               		.loc 1 156 40 is_stmt 0 view .LVU171
 754 01dc 8091 0000 		lds r24,tapping_key+5
 156:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 755               		.loc 1 156 24 view .LVU172
 756 01e0 8032      		cpi r24,lo8(32)
 757 01e2 00F0      		brlo .L54
 157:../../tmk_core/common/action_tapping.c ****                         // unregister key
 758               		.loc 1 157 25 is_stmt 1 view .LVU173
 159:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 759               		.loc 1 159 25 view .LVU174
 159:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 760               		.loc 1 159 54 is_stmt 0 view .LVU175
 761 01e4 2091 0000 		lds r18,tapping_key
 762 01e8 3091 0000 		lds r19,tapping_key+1
 763 01ec 3887      		std Y+8,r19
 764 01ee 2F83      		std Y+7,r18
 765 01f0 1986      		std Y+9,__zero_reg__
 766 01f2 1B87      		std Y+11,r17
 767 01f4 0A87      		std Y+10,r16
 768 01f6 8C87      		std Y+12,r24
 159:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 769               		.loc 1 159 25 view .LVU176
 770 01f8 CE01      		movw r24,r28
 771 01fa 0796      		adiw r24,7
 772               	.L120:
 159:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 773               		.loc 1 159 25 view .LVU177
 774 01fc 0E94 0000 		call process_action
 775               	.LVL49:
 776               	.L54:
 166:../../tmk_core/common/action_tapping.c ****                     }
 777               		.loc 1 166 25 is_stmt 1 view .LVU178
 168:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 778               		.loc 1 168 21 view .LVU179
 168:../../tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 779               		.loc 1 168 33 is_stmt 0 view .LVU180
 780 0200 86E0      		ldi r24,lo8(6)
 781 0202 F601      		movw r30,r12
 782 0204 A0E0      		ldi r26,lo8(tapping_key)
 783 0206 B0E0      		ldi r27,hi8(tapping_key)
 784               		0:
 785 0208 0190      		ld r0,Z+
 786 020a 0D92      		st X+,r0
 787 020c 8A95      		dec r24
 788 020e 01F4      		brne 0b
 169:../../tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 789               		.loc 1 169 21 is_stmt 1 view .LVU181
 790 0210 0E94 0000 		call waiting_buffer_scan_tap
 791               	.LVL50:
 170:../../tmk_core/common/action_tapping.c ****                     return true;
 792               		.loc 1 170 21 view .LVU182
 793 0214 0E94 0000 		call debug_tapping_key
 794               	.LVL51:
 171:../../tmk_core/common/action_tapping.c ****                 }
 795               		.loc 1 171 21 view .LVU183
 796               	.L124:
 178:../../tmk_core/common/action_tapping.c ****                 }
 797               		.loc 1 178 21 view .LVU184
 178:../../tmk_core/common/action_tapping.c ****                 }
 798               		.loc 1 178 28 is_stmt 0 view .LVU185
 799 0218 EE24      		clr r14
 800 021a E394      		inc r14
 801 021c 00C0      		rjmp .L29
 802               	.LVL52:
 803               	.L36:
 184:../../tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 804               		.loc 1 184 13 is_stmt 1 view .LVU186
 184:../../tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 805               		.loc 1 184 16 is_stmt 0 view .LVU187
 806 021e 9111      		cpse r25,__zero_reg__
 807 0220 00C0      		rjmp .L55
 185:../../tmk_core/common/action_tapping.c ****                 debug_event(event); debug("\n");
 808               		.loc 1 185 17 is_stmt 1 view .LVU188
 186:../../tmk_core/common/action_tapping.c ****                 process_action(&tapping_key);
 809               		.loc 1 186 17 view .LVU189
 186:../../tmk_core/common/action_tapping.c ****                 process_action(&tapping_key);
 810               		.loc 1 186 17 is_stmt 0 view .LVU190
 811 0222 702F      		mov r23,r16
 812 0224 198B      		std Y+17,r17
 813 0226 088B      		std Y+16,r16
 814 0228 6F2D      		mov r22,r15
 815 022a 8989      		ldd r24,Y+17
 816 022c 0E94 0000 		call debug_event
 817               	.LVL53:
 186:../../tmk_core/common/action_tapping.c ****                 process_action(&tapping_key);
 818               		.loc 1 186 37 is_stmt 1 view .LVU191
 187:../../tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 819               		.loc 1 187 17 view .LVU192
 820 0230 80E0      		ldi r24,lo8(tapping_key)
 821 0232 90E0      		ldi r25,hi8(tapping_key)
 822 0234 0E94 0000 		call process_action
 823               	.LVL54:
 188:../../tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 824               		.loc 1 188 17 view .LVU193
 825               	.L125:
 267:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 826               		.loc 1 267 33 view .LVU194
 268:../../tmk_core/common/action_tapping.c ****             debug_tapping_key();
 827               		.loc 1 268 13 view .LVU195
 268:../../tmk_core/common/action_tapping.c ****             debug_tapping_key();
 828               		.loc 1 268 25 is_stmt 0 view .LVU196
 829 0238 86E0      		ldi r24,lo8(6)
 830 023a E0E0      		ldi r30,lo8(tapping_key)
 831 023c F0E0      		ldi r31,hi8(tapping_key)
 832 023e DF01      		movw r26,r30
 833               		0:
 834 0240 1D92      		st X+,__zero_reg__
 835 0242 8A95      		dec r24
 836 0244 01F4      		brne 0b
 837 0246 00C0      		rjmp .L123
 838               	.LVL55:
 839               	.L55:
 192:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 840               		.loc 1 192 17 is_stmt 1 discriminator 1 view .LVU197
 192:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 841               		.loc 1 192 21 is_stmt 0 discriminator 1 view .LVU198
 842 0248 3513      		cpse r19,r21
 843 024a 00C0      		rjmp .L56
 192:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 844               		.loc 1 192 21 discriminator 2 view .LVU199
 845 024c 2413      		cpse r18,r20
 846 024e 00C0      		rjmp .L56
 192:../../tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 847               		.loc 1 192 47 discriminator 3 view .LVU200
 848 0250 F110      		cpse r15,__zero_reg__
 849 0252 00C0      		rjmp .L56
 193:../../tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 850               		.loc 1 193 21 is_stmt 1 view .LVU201
 194:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 851               		.loc 1 194 21 view .LVU202
 194:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 852               		.loc 1 194 31 is_stmt 0 view .LVU203
 853 0254 F601      		movw r30,r12
 854 0256 8583      		std Z+5,r24
 195:../../tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 855               		.loc 1 195 21 is_stmt 1 view .LVU204
 856 0258 C601      		movw r24,r12
 857 025a 0E94 0000 		call process_action
 858               	.LVL56:
 196:../../tmk_core/common/action_tapping.c ****                     return true;
 859               		.loc 1 196 21 view .LVU205
 196:../../tmk_core/common/action_tapping.c ****                     return true;
 860               		.loc 1 196 33 is_stmt 0 view .LVU206
 861 025e E0E0      		ldi r30,lo8(tapping_key)
 862 0260 F0E0      		ldi r31,hi8(tapping_key)
 863 0262 86E0      		ldi r24,lo8(6)
 864 0264 DF01      		movw r26,r30
 865               		0:
 866 0266 1D92      		st X+,__zero_reg__
 867 0268 8A95      		dec r24
 868 026a 01F4      		brne 0b
 869 026c 00C0      		rjmp .L122
 870               	.LVL57:
 871               	.L56:
 199:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 872               		.loc 1 199 22 is_stmt 1 view .LVU207
 199:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 873               		.loc 1 199 26 is_stmt 0 view .LVU208
 874 026e 4D87      		std Y+13,r20
 875 0270 5E87      		std Y+14,r21
 876 0272 FF86      		std Y+15,r15
 877 0274 702F      		mov r23,r16
 878 0276 198B      		std Y+17,r17
 879 0278 088B      		std Y+16,r16
 880 027a 6F2D      		mov r22,r15
 881 027c 8989      		ldd r24,Y+17
 882 027e 0E94 0000 		call is_tap_key
 883               	.LVL58:
 199:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 884               		.loc 1 199 25 view .LVU209
 885 0282 8823      		tst r24
 886 0284 01F4      		brne .+2
 887 0286 00C0      		rjmp .L63
 199:../../tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 888               		.loc 1 199 44 discriminator 1 view .LVU210
 889 0288 FF20      		tst r15
 890 028a 01F4      		brne .+2
 891 028c 00C0      		rjmp .L63
 200:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 892               		.loc 1 200 21 is_stmt 1 view .LVU211
 200:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 893               		.loc 1 200 40 is_stmt 0 view .LVU212
 894 028e 8091 0000 		lds r24,tapping_key+5
 200:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 895               		.loc 1 200 24 view .LVU213
 896 0292 8032      		cpi r24,lo8(32)
 897 0294 00F4      		brsh .+2
 898 0296 00C0      		rjmp .L54
 201:../../tmk_core/common/action_tapping.c ****                         // unregister key
 899               		.loc 1 201 25 is_stmt 1 view .LVU214
 203:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 900               		.loc 1 203 25 view .LVU215
 203:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 901               		.loc 1 203 54 is_stmt 0 view .LVU216
 902 0298 2091 0000 		lds r18,tapping_key
 903 029c 3091 0000 		lds r19,tapping_key+1
 904 02a0 3A83      		std Y+2,r19
 905 02a2 2983      		std Y+1,r18
 906 02a4 1B82      		std Y+3,__zero_reg__
 907 02a6 1D83      		std Y+5,r17
 908 02a8 0C83      		std Y+4,r16
 909 02aa 8E83      		std Y+6,r24
 203:../../tmk_core/common/action_tapping.c ****                                 .tap = tapping_key.tap,
 910               		.loc 1 203 25 view .LVU217
 911 02ac CE01      		movw r24,r28
 912 02ae 0196      		adiw r24,1
 913 02b0 00C0      		rjmp .L120
 914               	.LVL59:
 915               	.L31:
 226:../../tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 916               		.loc 1 226 12 is_stmt 1 discriminator 1 view .LVU218
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 917               		.loc 1 227 9 discriminator 1 view .LVU219
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 918               		.loc 1 227 13 is_stmt 0 discriminator 1 view .LVU220
 919 02b2 0817      		cp r16,r24
 920 02b4 1907      		cpc r17,r25
 921 02b6 00F0      		brlo .L58
 922 02b8 F801      		movw r30,r16
 923 02ba E81B      		sub r30,r24
 924 02bc F90B      		sbc r31,r25
 925 02be CF01      		movw r24,r30
 926 02c0 8C32      		cpi r24,44
 927 02c2 9140      		sbci r25,1
 928 02c4 00F0      		brlo .L88
 929               	.L121:
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 930               		.loc 1 227 13 discriminator 2 view .LVU221
 931 02c6 E12C      		mov r14,__zero_reg__
 266:../../tmk_core/common/action_tapping.c ****             debug_event(event); debug("\n");
 932               		.loc 1 266 13 is_stmt 1 discriminator 2 view .LVU222
 267:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 933               		.loc 1 267 13 discriminator 2 view .LVU223
 267:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 934               		.loc 1 267 13 is_stmt 0 discriminator 2 view .LVU224
 935 02c8 702F      		mov r23,r16
 936 02ca 198B      		std Y+17,r17
 937 02cc 088B      		std Y+16,r16
 938 02ce 6F2D      		mov r22,r15
 939 02d0 8989      		ldd r24,Y+17
 940 02d2 0E94 0000 		call debug_event
 941               	.LVL60:
 267:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 942               		.loc 1 267 13 discriminator 2 view .LVU225
 943 02d6 00C0      		rjmp .L125
 944               	.LVL61:
 945               	.L58:
 227:../../tmk_core/common/action_tapping.c ****             if (event.pressed) {
 946               		.loc 1 227 13 discriminator 2 view .LVU226
 947 02d8 8095      		com r24
 948 02da 9095      		com r25
 949 02dc 800F      		add r24,r16
 950 02de 911F      		adc r25,r17
 951 02e0 8C32      		cpi r24,44
 952 02e2 9140      		sbci r25,1
 953 02e4 00F4      		brsh .L121
 954               	.L88:
 228:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 955               		.loc 1 228 13 is_stmt 1 view .LVU227
 228:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 956               		.loc 1 228 22 is_stmt 0 view .LVU228
 957 02e6 EF2C      		mov r14,r15
 228:../../tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 958               		.loc 1 228 16 view .LVU229
 959 02e8 FF20      		tst r15
 960 02ea 01F4      		brne .+2
 961 02ec 00C0      		rjmp .L63
 962               	.LVL62:
 229:../../tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 963               		.loc 1 229 17 is_stmt 1 discriminator 1 view .LVU230
 229:../../tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 964               		.loc 1 229 21 is_stmt 0 discriminator 1 view .LVU231
 965 02ee 3513      		cpse r19,r21
 966 02f0 00C0      		rjmp .L64
 229:../../tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 967               		.loc 1 229 21 discriminator 2 view .LVU232
 968 02f2 2413      		cpse r18,r20
 969 02f4 00C0      		rjmp .L64
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 970               		.loc 1 230 21 is_stmt 1 view .LVU233
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 971               		.loc 1 230 41 is_stmt 0 view .LVU234
 972 02f6 8091 0000 		lds r24,tapping_key+5
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 973               		.loc 1 230 24 view .LVU235
 974 02fa 80FD      		sbrc r24,0
 975 02fc 00C0      		rjmp .L65
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 976               		.loc 1 230 79 discriminator 1 view .LVU236
 977 02fe 982F      		mov r25,r24
 978 0300 907F      		andi r25,lo8(-16)
 230:../../tmk_core/common/action_tapping.c ****                         // sequential tap.
 979               		.loc 1 230 54 discriminator 1 view .LVU237
 980 0302 01F0      		breq .L65
 232:../../tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 981               		.loc 1 232 25 is_stmt 1 view .LVU238
 232:../../tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 982               		.loc 1 232 35 is_stmt 0 view .LVU239
 983 0304 D601      		movw r26,r12
 984 0306 1596      		adiw r26,5
 985 0308 8C93      		st X,r24
 986 030a 1597      		sbiw r26,5
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 987               		.loc 1 233 25 is_stmt 1 view .LVU240
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 988               		.loc 1 233 28 is_stmt 0 view .LVU241
 989 030c 903F      		cpi r25,lo8(-16)
 990 030e 01F0      		breq .L66
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 991               		.loc 1 233 51 is_stmt 1 discriminator 1 view .LVU242
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 992               		.loc 1 233 67 is_stmt 0 discriminator 1 view .LVU243
 993 0310 982F      		mov r25,r24
 994 0312 907F      		andi r25,lo8(-16)
 995 0314 905F      		subi r25,lo8(-(16))
 996 0316 8F70      		andi r24,lo8(15)
 997 0318 892B      		or r24,r25
 998               	.LVL63:
 999               	.L126:
 233:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press("); debug_dec(keyp->tap.count); debug(")\n");
 1000               		.loc 1 233 67 discriminator 1 view .LVU244
 1001 031a 1596      		adiw r26,5
 1002 031c 8C93      		st X,r24
 1003               	.L66:
 234:../../tmk_core/common/action_tapping.c ****                         process_action(keyp);
 1004               		.loc 1 234 25 is_stmt 1 view .LVU245
 234:../../tmk_core/common/action_tapping.c ****                         process_action(keyp);
 1005               		.loc 1 234 55 view .LVU246
 234:../../tmk_core/common/action_tapping.c ****                         process_action(keyp);
 1006               		.loc 1 234 83 view .LVU247
 235:../../tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 1007               		.loc 1 235 25 view .LVU248
 1008 031e C601      		movw r24,r12
 1009 0320 0E94 0000 		call process_action
 1010               	.LVL64:
 236:../../tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 1011               		.loc 1 236 25 view .LVU249
 236:../../tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 1012               		.loc 1 236 37 is_stmt 0 view .LVU250
 1013 0324 86E0      		ldi r24,lo8(6)
 1014 0326 F601      		movw r30,r12
 1015 0328 A0E0      		ldi r26,lo8(tapping_key)
 1016 032a B0E0      		ldi r27,hi8(tapping_key)
 1017               		0:
 1018 032c 0190      		ld r0,Z+
 1019 032e 0D92      		st X+,r0
 1020 0330 8A95      		dec r24
 1021 0332 01F4      		brne 0b
 237:../../tmk_core/common/action_tapping.c ****                         return true;
 1022               		.loc 1 237 25 is_stmt 1 view .LVU251
 1023               	.L123:
 269:../../tmk_core/common/action_tapping.c ****             return false;
 1024               		.loc 1 269 13 view .LVU252
 1025 0334 0E94 0000 		call debug_tapping_key
 1026               	.LVL65:
 270:../../tmk_core/common/action_tapping.c ****         }
 1027               		.loc 1 270 13 view .LVU253
 270:../../tmk_core/common/action_tapping.c ****         }
 1028               		.loc 1 270 20 is_stmt 0 view .LVU254
 1029 0338 00C0      		rjmp .L29
 1030               	.LVL66:
 1031               	.L65:
 241:../../tmk_core/common/action_tapping.c ****                         return true;
 1032               		.loc 1 241 25 is_stmt 1 view .LVU255
 241:../../tmk_core/common/action_tapping.c ****                         return true;
 1033               		.loc 1 241 37 is_stmt 0 view .LVU256
 1034 033a 86E0      		ldi r24,lo8(6)
 1035 033c F601      		movw r30,r12
 1036 033e A0E0      		ldi r26,lo8(tapping_key)
 1037 0340 B0E0      		ldi r27,hi8(tapping_key)
 1038               		0:
 1039 0342 0190      		ld r0,Z+
 1040 0344 0D92      		st X+,r0
 1041 0346 8A95      		dec r24
 1042 0348 01F4      		brne 0b
 242:../../tmk_core/common/action_tapping.c ****                     }
 1043               		.loc 1 242 25 is_stmt 1 view .LVU257
 242:../../tmk_core/common/action_tapping.c ****                     }
 1044               		.loc 1 242 32 is_stmt 0 view .LVU258
 1045 034a 00C0      		rjmp .L29
 1046               	.L64:
 244:../../tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1047               		.loc 1 244 24 is_stmt 1 view .LVU259
 244:../../tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1048               		.loc 1 244 28 is_stmt 0 view .LVU260
 1049 034c 4D87      		std Y+13,r20
 1050 034e 5E87      		std Y+14,r21
 1051 0350 FF86      		std Y+15,r15
 1052 0352 702F      		mov r23,r16
 1053 0354 198B      		std Y+17,r17
 1054 0356 088B      		std Y+16,r16
 1055 0358 6F2D      		mov r22,r15
 1056 035a 8989      		ldd r24,Y+17
 1057 035c 0E94 0000 		call is_tap_key
 1058               	.LVL67:
 244:../../tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1059               		.loc 1 244 27 view .LVU261
 1060 0360 8111      		cpse r24,__zero_reg__
 1061 0362 00C0      		rjmp .L54
 254:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 1062               		.loc 1 254 21 is_stmt 1 view .LVU262
 254:../../tmk_core/common/action_tapping.c ****                     process_action(keyp);
 1063               		.loc 1 254 49 is_stmt 0 view .LVU263
 1064 0364 8091 0000 		lds r24,tapping_key+5
 1065 0368 8160      		ori r24,lo8(1<<0)
 1066 036a 8093 0000 		sts tapping_key+5,r24
 255:../../tmk_core/common/action_tapping.c ****                     return true;
 1067               		.loc 1 255 21 is_stmt 1 view .LVU264
 1068 036e C601      		movw r24,r12
 1069 0370 0E94 0000 		call process_action
 1070               	.LVL68:
 256:../../tmk_core/common/action_tapping.c ****                 }
 1071               		.loc 1 256 21 view .LVU265
 256:../../tmk_core/common/action_tapping.c ****                 }
 1072               		.loc 1 256 28 is_stmt 0 view .LVU266
 1073 0374 00C0      		rjmp .L29
 1074               	.LVL69:
 1075               	.L30:
 275:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1076               		.loc 1 275 9 is_stmt 1 view .LVU267
 275:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1077               		.loc 1 275 12 is_stmt 0 view .LVU268
 1078 0376 FF20      		tst r15
 1079 0378 01F0      		breq .L63
 275:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1080               		.loc 1 275 30 discriminator 1 view .LVU269
 1081 037a 4D87      		std Y+13,r20
 1082 037c 5E87      		std Y+14,r21
 1083 037e FF86      		std Y+15,r15
 1084 0380 702F      		mov r23,r16
 1085 0382 198B      		std Y+17,r17
 1086 0384 088B      		std Y+16,r16
 1087 0386 6F2D      		mov r22,r15
 1088 0388 8989      		ldd r24,Y+17
 1089 038a 0E94 0000 		call is_tap_key
 1090               	.LVL70:
 275:../../tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1091               		.loc 1 275 27 discriminator 1 view .LVU270
 1092 038e 8111      		cpse r24,__zero_reg__
 1093 0390 00C0      		rjmp .L54
 1094               	.LVL71:
 1095               	.L63:
 174:../../tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 1096               		.loc 1 174 21 is_stmt 1 view .LVU271
 175:../../tmk_core/common/action_tapping.c ****                     }
 1097               		.loc 1 175 25 view .LVU272
 177:../../tmk_core/common/action_tapping.c ****                     return true;
 1098               		.loc 1 177 21 view .LVU273
 1099 0392 C601      		movw r24,r12
 1100 0394 0E94 0000 		call process_action
 1101               	.LVL72:
 1102 0398 00C0      		rjmp .L124
 1103               	.LVL73:
 1104               	.L41:
 1105               	.LBB39:
 1106               	.LBB31:
 1107               		.loc 2 51 79 is_stmt 0 view .LVU274
 1108 039a 81E0      		ldi r24,lo8(1)
 1109 039c 8F25      		eor r24,r15
 1110 039e 00C0      		rjmp .L40
 1111               	.LBE31:
 1112               	.LBE39:
 1113               		.cfi_endproc
 1114               	.LFE5:
 1116               		.section	.text.action_tapping_process,"ax",@progbits
 1117               	.global	action_tapping_process
 1119               	action_tapping_process:
 1120               	.LFB4:
  39:../../tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
 1121               		.loc 1 39 1 is_stmt 1 view -0
 1122               		.cfi_startproc
 1123 0000 1F93      		push r17
 1124               	.LCFI17:
 1125               		.cfi_def_cfa_offset 3
 1126               		.cfi_offset 17, -2
 1127 0002 CF93      		push r28
 1128               	.LCFI18:
 1129               		.cfi_def_cfa_offset 4
 1130               		.cfi_offset 28, -3
 1131 0004 DF93      		push r29
 1132               	.LCFI19:
 1133               		.cfi_def_cfa_offset 5
 1134               		.cfi_offset 29, -4
 1135 0006 CDB7      		in r28,__SP_L__
 1136 0008 DEB7      		in r29,__SP_H__
 1137               	.LCFI20:
 1138               		.cfi_def_cfa_register 28
 1139 000a 2C97      		sbiw r28,12
 1140               	.LCFI21:
 1141               		.cfi_def_cfa_offset 17
 1142 000c 0FB6      		in __tmp_reg__,__SREG__
 1143 000e F894      		cli
 1144 0010 DEBF      		out __SP_H__,r29
 1145 0012 0FBE      		out __SREG__,__tmp_reg__
 1146 0014 CDBF      		out __SP_L__,r28
 1147               	/* prologue: function */
 1148               	/* frame size = 12 */
 1149               	/* stack size = 15 */
 1150               	.L__stack_usage = 15
 1151 0016 4F83      		std Y+7,r20
 1152 0018 5887      		std Y+8,r21
 1153 001a 6987      		std Y+9,r22
 1154 001c 7A87      		std Y+10,r23
 1155 001e 8B87      		std Y+11,r24
 1156 0020 9C87      		std Y+12,r25
  40:../../tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1157               		.loc 1 40 5 view .LVU276
  40:../../tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1158               		.loc 1 40 9 is_stmt 0 view .LVU277
 1159 0022 CE01      		movw r24,r28
 1160 0024 0796      		adiw r24,7
 1161 0026 0E94 0000 		call process_tapping
 1162               	.LVL74:
  40:../../tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1163               		.loc 1 40 8 view .LVU278
 1164 002a 8823      		tst r24
 1165 002c 01F0      		breq .L128
  41:../../tmk_core/common/action_tapping.c ****             debug("processed: "); debug_record(record); debug("\n");
 1166               		.loc 1 41 9 is_stmt 1 view .LVU279
 1167               	.LBB48:
 1168               	.LBI48:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1169               		.loc 2 49 20 view .LVU280
 1170               	.LBB49:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1171               		.loc 2 49 51 view .LVU281
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1172               		.loc 2 49 74 is_stmt 0 view .LVU282
 1173 002e 8A85      		ldd r24,Y+10
 1174 0030 9B85      		ldd r25,Y+11
 1175 0032 892B      		or r24,r25
 1176 0034 01F0      		breq .L129
 1177 0036 4F81      		ldd r20,Y+7
 1178 0038 5885      		ldd r21,Y+8
 1179 003a 842F      		mov r24,r20
 1180 003c 8523      		and r24,r21
 1181 003e 8F3F      		cpi r24,lo8(-1)
 1182 0040 01F0      		breq .+2
 1183 0042 00C0      		rjmp .L151
 1184               	.L129:
 1185               	.LBE49:
 1186               	.LBE48:
  59:../../tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1187               		.loc 1 59 13 discriminator 1 view .LVU283
 1188 0044 16E0      		ldi r17,lo8(6)
 1189 0046 00C0      		rjmp .L136
 1190               	.L128:
  45:../../tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
 1191               		.loc 1 45 9 is_stmt 1 view .LVU284
 1192 0048 86E0      		ldi r24,lo8(6)
 1193 004a FE01      		movw r30,r28
 1194 004c 3796      		adiw r30,7
 1195 004e DE01      		movw r26,r28
 1196 0050 1196      		adiw r26,1
 1197               		0:
 1198 0052 0190      		ld r0,Z+
 1199 0054 0D92      		st X+,r0
 1200 0056 8A95      		dec r24
 1201 0058 01F4      		brne 0b
 1202               	.LVL75:
 1203               	.LBB50:
 1204               	.LBI50:
 292:../../tmk_core/common/action_tapping.c **** {
 1205               		.loc 1 292 6 view .LVU285
 1206               	.LBB51:
 294:../../tmk_core/common/action_tapping.c ****         return true;
 1207               		.loc 1 294 5 view .LVU286
 1208               	.LBB52:
 1209               	.LBI52:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1210               		.loc 2 49 20 view .LVU287
 1211               	.LBB53:
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1212               		.loc 2 49 51 view .LVU288
  49:../../tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1213               		.loc 2 49 74 is_stmt 0 view .LVU289
 1214 005a 8A85      		ldd r24,Y+10
 1215 005c 9B85      		ldd r25,Y+11
 1216 005e 892B      		or r24,r25
 1217 0060 01F0      		breq .L129
 1218 0062 8885      		ldd r24,Y+8
 1219 0064 9F81      		ldd r25,Y+7
 1220 0066 8923      		and r24,r25
 1221 0068 8F3F      		cpi r24,lo8(-1)
 1222 006a 01F0      		breq .L129
 1223               	.LBE53:
 1224               	.LBE52:
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1225               		.loc 1 298 5 is_stmt 1 view .LVU290
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1226               		.loc 1 298 30 is_stmt 0 view .LVU291
 1227 006c 2091 0000 		lds r18,waiting_buffer_head
 1228 0070 30E0      		ldi r19,0
 1229 0072 C901      		movw r24,r18
 1230 0074 0196      		adiw r24,1
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1231               		.loc 1 298 35 view .LVU292
 1232 0076 8770      		andi r24,7
 1233 0078 9927      		clr r25
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1234               		.loc 1 298 57 view .LVU293
 1235 007a 4091 0000 		lds r20,waiting_buffer_tail
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1236               		.loc 1 298 8 view .LVU294
 1237 007e 4817      		cp r20,r24
 1238 0080 1906      		cpc __zero_reg__,r25
 1239 0082 01F4      		brne .L153
 1240               	.LVL76:
 298:../../tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1241               		.loc 1 298 8 view .LVU295
 1242               	.LBE51:
 1243               	.LBE50:
  47:../../tmk_core/common/action_tapping.c ****             clear_keyboard();
 1244               		.loc 1 47 13 is_stmt 1 view .LVU296
  48:../../tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
 1245               		.loc 1 48 13 view .LVU297
 1246 0084 0E94 0000 		call clear_keyboard
 1247               	.LVL77:
  49:../../tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1248               		.loc 1 49 13 view .LVU298
 1249               	.LBB55:
 1250               	.LBI55:
 310:../../tmk_core/common/action_tapping.c **** {
 1251               		.loc 1 310 6 view .LVU299
 1252               	.LBB56:
 312:../../tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1253               		.loc 1 312 5 view .LVU300
 312:../../tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1254               		.loc 1 312 25 is_stmt 0 view .LVU301
 1255 0088 1092 0000 		sts waiting_buffer_head,__zero_reg__
 313:../../tmk_core/common/action_tapping.c **** }
 1256               		.loc 1 313 5 is_stmt 1 view .LVU302
 313:../../tmk_core/common/action_tapping.c **** }
 1257               		.loc 1 313 25 is_stmt 0 view .LVU303
 1258 008c 1092 0000 		sts waiting_buffer_tail,__zero_reg__
 1259               	.LBE56:
 1260               	.LBE55:
  50:../../tmk_core/common/action_tapping.c ****         }
 1261               		.loc 1 50 13 is_stmt 1 view .LVU304
  50:../../tmk_core/common/action_tapping.c ****         }
 1262               		.loc 1 50 25 is_stmt 0 view .LVU305
 1263 0090 86E0      		ldi r24,lo8(6)
 1264 0092 E0E0      		ldi r30,lo8(tapping_key)
 1265 0094 F0E0      		ldi r31,hi8(tapping_key)
 1266 0096 DF01      		movw r26,r30
 1267               		0:
 1268 0098 1D92      		st X+,__zero_reg__
 1269 009a 8A95      		dec r24
 1270 009c 01F4      		brne 0b
 1271 009e 00C0      		rjmp .L129
 1272               	.LVL78:
 1273               	.L153:
 1274               	.LBB57:
 1275               	.LBB54:
 303:../../tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1276               		.loc 1 303 5 is_stmt 1 view .LVU306
 303:../../tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1277               		.loc 1 303 41 is_stmt 0 view .LVU307
 1278 00a0 96E0      		ldi r25,lo8(6)
 1279               	.LVL79:
 303:../../tmk_core/common/action_tapping.c ****     waiting_buffer_head = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1280               		.loc 1 303 41 view .LVU308
 1281 00a2 929F      		mul r25,r18
 1282 00a4 D001      		movw r26,r0
 1283 00a6 939F      		mul r25,r19
 1284 00a8 B00D      		add r27,r0
 1285 00aa 1124      		clr __zero_reg__
 1286 00ac A050      		subi r26,lo8(-(waiting_buffer))
 1287 00ae B040      		sbci r27,hi8(-(waiting_buffer))
 1288 00b0 FE01      		movw r30,r28
 1289 00b2 3196      		adiw r30,1
 1290               		0:
 1291 00b4 0190      		ld r0,Z+
 1292 00b6 0D92      		st X+,r0
 1293 00b8 9A95      		dec r25
 1294 00ba 01F4      		brne 0b
 304:../../tmk_core/common/action_tapping.c **** 
 1295               		.loc 1 304 5 is_stmt 1 view .LVU309
 304:../../tmk_core/common/action_tapping.c **** 
 1296               		.loc 1 304 25 is_stmt 0 view .LVU310
 1297 00bc 8093 0000 		sts waiting_buffer_head,r24
 306:../../tmk_core/common/action_tapping.c ****     return true;
 1298               		.loc 1 306 5 is_stmt 1 view .LVU311
 306:../../tmk_core/common/action_tapping.c ****     return true;
 1299               		.loc 1 306 36 view .LVU312
 1300 00c0 0E94 0000 		call debug_waiting_buffer
 1301               	.LVL80:
 307:../../tmk_core/common/action_tapping.c **** }
 1302               		.loc 1 307 5 view .LVU313
 307:../../tmk_core/common/action_tapping.c **** }
 1303               		.loc 1 307 5 is_stmt 0 view .LVU314
 1304 00c4 00C0      		rjmp .L129
 1305               	.L134:
 307:../../tmk_core/common/action_tapping.c **** }
 1306               		.loc 1 307 5 view .LVU315
 1307               	.LBE54:
 1308               	.LBE57:
  59:../../tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1309               		.loc 1 59 9 is_stmt 1 view .LVU316
  59:../../tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1310               		.loc 1 59 13 is_stmt 0 view .LVU317
 1311 00c6 819F      		mul r24,r17
 1312 00c8 C001      		movw r24,r0
 1313 00ca 1124      		clr __zero_reg__
 1314 00cc 8050      		subi r24,lo8(-(waiting_buffer))
 1315 00ce 9040      		sbci r25,hi8(-(waiting_buffer))
 1316 00d0 0E94 0000 		call process_tapping
 1317               	.LVL81:
  59:../../tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer["); debug_dec(waiting_buffer_tail); debug("] = ");
 1318               		.loc 1 59 12 view .LVU318
 1319 00d4 8823      		tst r24
 1320 00d6 01F0      		breq .L127
  60:../../tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1321               		.loc 1 60 13 is_stmt 1 view .LVU319
  60:../../tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1322               		.loc 1 60 50 view .LVU320
  60:../../tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]); debug("\n\n");
 1323               		.loc 1 60 82 view .LVU321
  61:../../tmk_core/common/action_tapping.c ****         } else {
 1324               		.loc 1 61 13 view .LVU322
 1325 00d8 E091 0000 		lds r30,waiting_buffer_tail
 1326 00dc 1E9F      		mul r17,r30
 1327 00de F001      		movw r30,r0
 1328 00e0 1124      		clr __zero_reg__
 1329 00e2 E050      		subi r30,lo8(-(waiting_buffer))
 1330 00e4 F040      		sbci r31,hi8(-(waiting_buffer))
 1331 00e6 4081      		ld r20,Z
 1332 00e8 5181      		ldd r21,Z+1
 1333 00ea 6281      		ldd r22,Z+2
 1334 00ec 7381      		ldd r23,Z+3
 1335 00ee 8481      		ldd r24,Z+4
 1336 00f0 9581      		ldd r25,Z+5
 1337 00f2 0E94 0000 		call debug_record
 1338               	.LVL82:
  61:../../tmk_core/common/action_tapping.c ****         } else {
 1339               		.loc 1 61 64 view .LVU323
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1340               		.loc 1 58 99 is_stmt 0 view .LVU324
 1341 00f6 8091 0000 		lds r24,waiting_buffer_tail
 1342 00fa 90E0      		ldi r25,0
 1343 00fc 0196      		adiw r24,1
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1344               		.loc 1 58 104 view .LVU325
 1345 00fe 8770      		andi r24,7
 1346 0100 9927      		clr r25
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1347               		.loc 1 58 76 view .LVU326
 1348 0102 8093 0000 		sts waiting_buffer_tail,r24
 1349               	.L136:
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1350               		.loc 1 58 32 discriminator 1 view .LVU327
 1351 0106 8091 0000 		lds r24,waiting_buffer_tail
  58:../../tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1352               		.loc 1 58 5 discriminator 1 view .LVU328
 1353 010a 9091 0000 		lds r25,waiting_buffer_head
 1354 010e 8913      		cpse r24,r25
 1355 0110 00C0      		rjmp .L134
 1356               	.L127:
 1357               	/* epilogue start */
  69:../../tmk_core/common/action_tapping.c **** 
 1358               		.loc 1 69 1 view .LVU329
 1359 0112 2C96      		adiw r28,12
 1360 0114 0FB6      		in __tmp_reg__,__SREG__
 1361 0116 F894      		cli
 1362 0118 DEBF      		out __SP_H__,r29
 1363 011a 0FBE      		out __SREG__,__tmp_reg__
 1364 011c CDBF      		out __SP_L__,r28
 1365 011e DF91      		pop r29
 1366 0120 CF91      		pop r28
 1367 0122 1F91      		pop r17
 1368 0124 0895      		ret
 1369               	.L151:
  42:../../tmk_core/common/action_tapping.c ****         }
 1370               		.loc 1 42 13 is_stmt 1 view .LVU330
  42:../../tmk_core/common/action_tapping.c ****         }
 1371               		.loc 1 42 35 view .LVU331
 1372 0126 6985      		ldd r22,Y+9
 1373 0128 7A85      		ldd r23,Y+10
 1374 012a 8B85      		ldd r24,Y+11
 1375 012c 9C85      		ldd r25,Y+12
 1376 012e 0E94 0000 		call debug_record
 1377               	.LVL83:
 1378 0132 00C0      		rjmp .L129
 1379               		.cfi_endproc
 1380               	.LFE4:
 1382               		.section	.bss.waiting_buffer_tail,"aw",@nobits
 1385               	waiting_buffer_tail:
 1386 0000 00        		.zero	1
 1387               		.section	.bss.waiting_buffer_head,"aw",@nobits
 1390               	waiting_buffer_head:
 1391 0000 00        		.zero	1
 1392               		.section	.bss.waiting_buffer,"aw",@nobits
 1395               	waiting_buffer:
 1396 0000 0000 0000 		.zero	48
 1396      0000 0000 
 1396      0000 0000 
 1396      0000 0000 
 1396      0000 0000 
 1397               		.section	.bss.tapping_key,"aw",@nobits
 1400               	tapping_key:
 1401 0000 0000 0000 		.zero	6
 1401      0000 
 1402               		.text
 1403               	.Letext0:
 1404               		.file 3 "/usr/avr/include/stdint.h"
 1405               		.file 4 "../../tmk_core/common/keycode.h"
 1406               		.file 5 "../../tmk_core/common/action_code.h"
 1407               		.file 6 "../../tmk_core/common/action.h"
 1408               		.file 7 "../../tmk_core/common/action_layer.h"
 1409               		.file 8 "../../tmk_core/common/timer.h"
 1410               		.file 9 "../../tmk_core/common/avr/xprintf.h"
 1411               		.file 10 "../../tmk_core/common/debug.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 action_tapping.c
     /tmp/ccOYUmDJ.s:2      *ABS*:000000000000003e __SP_H__
     /tmp/ccOYUmDJ.s:3      *ABS*:000000000000003d __SP_L__
     /tmp/ccOYUmDJ.s:4      *ABS*:000000000000003f __SREG__
     /tmp/ccOYUmDJ.s:5      *ABS*:0000000000000000 __tmp_reg__
     /tmp/ccOYUmDJ.s:6      *ABS*:0000000000000001 __zero_reg__
     /tmp/ccOYUmDJ.s:12     .text.debug_waiting_buffer:0000000000000000 debug_waiting_buffer
     /tmp/ccOYUmDJ.s:1385   .bss.waiting_buffer_tail:0000000000000000 waiting_buffer_tail
     /tmp/ccOYUmDJ.s:1390   .bss.waiting_buffer_head:0000000000000000 waiting_buffer_head
     /tmp/ccOYUmDJ.s:1395   .bss.waiting_buffer:0000000000000000 waiting_buffer
     /tmp/ccOYUmDJ.s:94     .text.debug_tapping_key:0000000000000000 debug_tapping_key
     /tmp/ccOYUmDJ.s:1400   .bss.tapping_key:0000000000000000 tapping_key
     /tmp/ccOYUmDJ.s:117    .text.waiting_buffer_scan_tap:0000000000000000 waiting_buffer_scan_tap
     /tmp/ccOYUmDJ.s:296    .text.process_tapping:0000000000000000 process_tapping
     /tmp/ccOYUmDJ.s:1119   .text.action_tapping_process:0000000000000000 action_tapping_process

UNDEFINED SYMBOLS
debug_record
process_action
layer_switch_get_action
is_tap_key
debug_event
clear_keyboard
__do_clear_bss
